<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOIDM - BSQUAD | CODM Clan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS Variables for Theming */
        :root {
            --primary-color: #00ff00;
            --primary-dark: #00cc00;
            --secondary-color: #000000;
            --accent-color: #111111;
            --text-color: #ffffff;
            --text-secondary: #cccccc;
            --danger-color: #ff3333;
            --warning-color: #ffcc00;
            --success-color: #00cc66;
            --card-bg: #1a1a1a;
            --modal-bg: rgba(0, 0, 0, 0.85);
            --border-color: #333333;
            --shadow-color: rgba(0, 255, 0, 0.1);
            
            /* Layout */
            --header-height: 70px;
            --sidebar-width: 250px;
            --border-radius: 8px;
            --transition-speed: 0.3s;
        }
        
        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        button, input, select, textarea {
            font-family: inherit;
            font-size: inherit;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        .text-danger {
            color: var(--danger-color);
        }
        
        .text-success {
            color: var(--success-color);
        }
        
        .text-warning {
            color: var(--warning-color);
        }
        
        .text-primary {
            color: var(--primary-color);
        }
        
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }
        
        .flex {
            display: flex;
        }
        
        .flex-center {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .flex-between {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .flex-column {
            display: flex;
            flex-direction: column;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Header Styles */
        .header {
            background-color: var(--accent-color);
            height: var(--header-height);
            border-bottom: 2px solid var(--primary-color);
            box-shadow: 0 4px 12px var(--shadow-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            color: var(--primary-color);
            font-size: 2rem;
        }
        
        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 1px;
            background: linear-gradient(to right, var(--primary-color), #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .nav-links {
            display: flex;
            gap: 25px;
        }
        
        .nav-link {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            transition: all var(--transition-speed);
            font-weight: 500;
        }
        
        .nav-link:hover {
            background-color: rgba(0, 255, 0, 0.1);
            color: var(--primary-color);
        }
        
        .logout-btn {
            background-color: transparent;
            color: var(--danger-color);
            border: 1px solid var(--danger-color);
            padding: 8px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all var(--transition-speed);
            font-weight: 500;
        }
        
        .logout-btn:hover {
            background-color: var(--danger-color);
            color: white;
        }
        
        /* Main Content Area */
        .main-content {
            min-height: calc(100vh - var(--header-height));
            padding: 30px 0;
        }
        
        /* Card Styles */
        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 255, 0, 0.15);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Button Styles */
        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all var(--transition-speed);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--secondary-color);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background-color: var(--accent-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background-color: var(--border-color);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #cc0000;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #00994d;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 0.9rem;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--accent-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-color);
            transition: border-color var(--transition-speed);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2300ff00' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 15px;
            padding-right: 40px;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            cursor: pointer;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .radio-option input {
            accent-color: var(--primary-color);
        }
        
        /* File Upload */
        .file-upload {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: border-color var(--transition-speed);
        }
        
        .file-upload:hover {
            border-color: var(--primary-color);
        }
        
        .file-upload input {
            display: none;
        }
        
        .file-upload-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            color: var(--text-secondary);
        }
        
        .profile-pic-preview {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin: 0 auto 15px;
            display: block;
        }
        
        /* Tab Navigation */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            color: var(--text-secondary);
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all var(--transition-speed);
        }
        
        .tab:hover {
            color: var(--text-color);
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background-color: rgba(0, 255, 0, 0.05);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Table Styles */
        .table-container {
            overflow-x: auto;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th {
            background-color: var(--accent-color);
            color: var(--primary-color);
            text-align: left;
            padding: 15px;
            font-weight: 600;
            border-bottom: 2px solid var(--border-color);
        }
        
        .table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .table tr:hover {
            background-color: rgba(0, 255, 0, 0.05);
        }
        
        /* Badge Styles */
        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .badge-success {
            background-color: rgba(0, 204, 102, 0.2);
            color: var(--success-color);
        }
        
        .badge-warning {
            background-color: rgba(255, 204, 0, 0.2);
            color: var(--warning-color);
        }
        
        .badge-danger {
            background-color: rgba(255, 51, 51, 0.2);
            color: var(--danger-color);
        }
        
        .badge-info {
            background-color: rgba(0, 150, 255, 0.2);
            color: #0096ff;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--modal-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-speed), visibility var(--transition-speed);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid var(--primary-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform var(--transition-speed);
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color var(--transition-speed);
        }
        
        .modal-close:hover {
            color: var(--primary-color);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
        }
        
        .toast {
            background-color: var(--card-bg);
            border-left: 4px solid var(--primary-color);
            border-radius: var(--border-radius);
            padding: 15px 20px;
            margin-top: 10px;
            min-width: 300px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
            transform: translateX(100%);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
        }
        
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .toast-success {
            border-left-color: var(--success-color);
        }
        
        .toast-error {
            border-left-color: var(--danger-color);
        }
        
        .toast-warning {
            border-left-color: var(--warning-color);
        }
        
        .toast-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: var(--accent-color);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            border-top: 4px solid var(--primary-color);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Activity Feed */
        .activity-feed {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .activity-item {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            gap: 15px;
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            color: var(--primary-color);
            font-size: 1.2rem;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-time {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        /* Login & Registration Pages */
        .auth-container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .auth-logo {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .auth-title {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .auth-subtitle {
            color: var(--text-secondary);
        }
        
        .auth-footer {
            text-align: center;
            margin-top: 30px;
            color: var(--text-secondary);
        }
        
        /* Dashboard Layout */
        .dashboard {
            display: flex;
            gap: 30px;
        }
        
        .dashboard-sidebar {
            width: var(--sidebar-width);
            flex-shrink: 0;
        }
        
        .dashboard-content {
            flex: 1;
        }
        
        .user-info-card {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 20px;
        }
        
        .user-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin: 0 auto 20px;
        }
        
        .user-name {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .user-status {
            display: inline-block;
            margin-bottom: 15px;
        }
        
        /* Notification Bell */
        .notification-bell {
            position: relative;
            cursor: pointer;
            font-size: 1.3rem;
            color: var(--text-secondary);
            transition: color var(--transition-speed);
        }
        
        .notification-bell:hover {
            color: var(--primary-color);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger-color);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .notification-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            width: 300px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border-color);
            display: none;
            z-index: 100;
        }
        
        .notification-dropdown.show {
            display: block;
        }
        
        .notification-header {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notification-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .notification-item {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color var(--transition-speed);
        }
        
        .notification-item:hover {
            background-color: rgba(0, 255, 0, 0.05);
        }
        
        .notification-item.unread {
            background-color: rgba(0, 255, 0, 0.1);
        }
        
        /* WhatsApp Integration */
        .whatsapp-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #25D366;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
            z-index: 99;
            cursor: pointer;
            transition: transform var(--transition-speed);
        }
        
        .whatsapp-button:hover {
            transform: scale(1.1);
        }
        
        /* Event Announcement */
        .event-announcement {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to right, var(--primary-color), #00cc00);
            color: var(--secondary-color);
            padding: 15px 20px;
            text-align: center;
            z-index: 1000;
            animation: slideDown 0.5s ease-out;
            display: none;
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-100%);
            }
            to {
                transform: translateY(0);
            }
        }
        
        .event-announcement-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .event-close {
            background: none;
            border: none;
            color: var(--secondary-color);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .dashboard {
                flex-direction: column;
            }
            
            .dashboard-sidebar {
                width: 100%;
            }
            
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
                background: none;
                border: none;
                color: var(--text-color);
                font-size: 1.5rem;
                cursor: pointer;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                padding: 0 15px;
            }
            
            .logo-text {
                font-size: 1.2rem;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
            
            .tab {
                white-space: nowrap;
            }
            
            .event-announcement-content {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .modal {
                max-height: 95vh;
            }
            
            .table {
                font-size: 0.9rem;
            }
            
            .table th, .table td {
                padding: 10px 8px;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--accent-color);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
    </style>
</head>
<body>
    <!-- Event Announcement Banner -->
    <div class="event-announcement" id="eventAnnouncement">
        <div class="event-announcement-content">
            <div id="eventAnnouncementMessage"></div>
            <button class="event-close" id="closeEventAnnouncement">&times;</button>
        </div>
    </div>

    <!-- Header Section -->
    <header class="header hidden" id="mainHeader">
        <div class="container header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="logo-text" id="clanName">VOIDM - BSQUAD</div>
            </div>
            
            <div class="nav-links">
                <a href="#" class="nav-link" data-tab="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="#" class="nav-link" data-tab="profile">
                    <i class="fas fa-user"></i> Profile
                </a>
                <a href="#" class="nav-link" data-tab="clan">
                    <i class="fas fa-users"></i> Clan Info
                </a>
                <a href="#" class="nav-link" data-tab="applications" id="applicationsTabLink">
                    <i class="fas fa-file-alt"></i> Applications
                </a>
                <a href="#" class="nav-link" data-tab="settings">
                    <i class="fas fa-cog"></i> Settings
                </a>
                <a href="#" class="nav-link hidden" id="eventsTabLink" data-tab="events">
                    <i class="fas fa-calendar-alt"></i> Events
                </a>
                <div class="notification-container">
                    <div class="notification-bell" id="notificationBell">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge hidden" id="notificationBadge">0</span>
                    </div>
                    <div class="notification-dropdown" id="notificationDropdown">
                        <div class="notification-header">
                            <h4>Notifications</h4>
                            <button class="btn btn-small btn-primary" id="markAllRead">Mark all read</button>
                        </div>
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be dynamically added here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Login Page -->
        <section class="container" id="loginPage">
            <div class="auth-container">
                <div class="auth-header">
                    <div class="auth-logo">
                        <i class="fas fa-gamepad"></i>
                    </div>
                    <h1 class="auth-title" id="websiteName">VOIDM - BSQUAD</h1>
                    <p class="auth-subtitle">Call of Duty: Mobile Clan Management System</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-sign-in-alt"></i> Login</h2>
                    </div>
                    
                    <form id="loginForm">
                        <div class="form-group">
                            <label class="form-label" for="loginUsername">Username</label>
                            <input type="text" id="loginUsername" class="form-control" placeholder="Enter your username" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="loginPassword">Password</label>
                            <div class="input-with-icon">
                                <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
                                <span class="input-icon" id="toggleLoginPassword">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                        </div>
                        
                        <div class="form-group flex-between">
                            <div class="flex">
                                <input type="checkbox" id="rememberMe" checked>
                                <label for="rememberMe" style="margin-left: 8px;">Remember me</label>
                            </div>
                            <a href="#" id="forgotPasswordLink">Forgot Password?</a>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-block mb-2">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                        
                        <button type="button" class="btn btn-secondary btn-block" id="goToRegister">
                            <i class="fas fa-user-plus"></i> Create New Account
                        </button>
                    </form>
                </div>
                
                <div class="auth-footer">
                    <p>Don't have an account? <a href="#" id="registerLink">Register here</a></p>
                    <p class="mt-2"><small>Admin: crypto / mumuboi </small></p>
                </div>
            </div>
        </section>

        <!-- Registration Page -->
        <section class="container hidden" id="registerPage">
            <div class="auth-container">
                <div class="auth-header">
                    <div class="auth-logo">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <h1 class="auth-title">Join VOIDM - BSQUAD</h1>
                    <p class="auth-subtitle">Create your account and apply to join our clan</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-user-edit"></i> Registration</h2>
                    </div>
                    
                    <form id="registerForm">
                        <h3 class="mb-2" style="color: var(--primary-color);">Account Details</h3>
                        
                        <div class="form-group">
                            <label class="form-label" for="regUsername">Username *</label>
                            <input type="text" id="regUsername" class="form-control" placeholder="Choose a username" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="regPassword">Password *</label>
                            <div class="input-with-icon">
                                <input type="password" id="regPassword" class="form-control" placeholder="Create a password" required>
                                <span class="input-icon" id="toggleRegPassword">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="regConfirmPassword">Confirm Password *</label>
                            <input type="password" id="regConfirmPassword" class="form-control" placeholder="Confirm your password" required>
                        </div>
                        
                        <h3 class="mb-2 mt-4" style="color: var(--primary-color);">CODM Game Details</h3>
                        
                        <div class="form-group">
                            <label class="form-label" for="regCODMName">CODM In-Game Name *</label>
                            <input type="text" id="regCODMName" class="form-control" placeholder="Your CODM username" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="regLevel">Player Level *</label>
                            <input type="number" id="regLevel" class="form-control" min="1" max="400" placeholder="Your CODM level (Max: 400)" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="regMPRank">MP Rank *</label>
                            <select id="regMPRank" class="form-control form-select" required>
                                <option value="">Select MP Rank</option>
                                <option value="Rookie">Rookie</option>
                                <option value="Veteran">Veteran</option>
                                <option value="Elite">Elite</option>
                                <option value="Pro">Pro</option>
                                <option value="Master">Master</option>
                                <option value="Grandmaster">Grandmaster</option>
                                <option value="Legendary">Legendary</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="regBRRank">BR Rank *</label>
                            <select id="regBRRank" class="form-control form-select" required>
                                <option value="">Select BR Rank</option>
                                <option value="Rookie">Rookie</option>
                                <option value="Veteran">Veteran</option>
                                <option value="Elite">Elite</option>
                                <option value="Pro">Pro</option>
                                <option value="Master">Master</option>
                                <option value="Grandmaster">Grandmaster</option>
                                <option value="Legendary">Legendary</option>
                            </select>
                        </div>
                        
                        <h3 class="mb-2 mt-4" style="color: var(--primary-color);">Personal Details</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Gender</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="Male" checked>
                                    Male
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="Female">
                                    Female
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="Other">
                                    Other
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="regDOB">Date of Birth *</label>
                            <input type="date" id="regDOB" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Profile Picture</label>
                            <div class="file-upload">
                                <input type="file" id="regProfilePic" accept="image/*">
                                <label for="regProfilePic" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt fa-2x"></i>
                                    <span>Click to upload profile picture</span>
                                    <span style="font-size: 0.9rem;">(Max 2MB, JPG/PNG)</span>
                                </label>
                            </div>
                            <div class="text-center mt-2">
                                <img src="" alt="Preview" class="profile-pic-preview hidden" id="profilePicPreview">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <input type="checkbox" id="acceptTerms" required>
                            <label for="acceptTerms">I agree to the clan rules and terms of service</label>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-block mb-2">
                            <i class="fas fa-user-plus"></i> Create Account
                        </button>
                        
                        <button type="button" class="btn btn-secondary btn-block" id="goToLogin">
                            <i class="fas fa-arrow-left"></i> Back to Login
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <!-- User Dashboard -->
        <section class="container hidden" id="dashboardPage">
            <div class="dashboard">
                <!-- Sidebar -->
                <aside class="dashboard-sidebar">
                    <div class="card user-info-card">
                        <img src="" alt="User Avatar" class="user-avatar" id="sidebarAvatar">
                        <h3 class="user-name" id="sidebarUsername">Username</h3>
                        <div class="user-status">
                            <span class="badge" id="sidebarStatus">Member</span>
                        </div>
                        <p id="sidebarCODMName">CODM: PlayerName</p>
                        <p id="sidebarJoinDate">Joined: Jan 2023</p>
                        
                        <div class="mt-3">
                            <button class="btn btn-primary btn-block" id="applyToClanBtn">
                                <i class="fas fa-paper-plane"></i> Apply to Clan
                            </button>
                        </div>
                    </div>
                    
                    <div class="card mb-2">
                        <h4 class="card-title"><i class="fas fa-trophy"></i> Quick Stats</h4>
                        <div class="mt-2">
                            <p><strong>MP Rank:</strong> <span id="sidebarMPRank">Legendary</span></p>
                            <p><strong>BR Rank:</strong> <span id="sidebarBRRank">Legendary</span></p>
                            <p><strong>Level:</strong> <span id="sidebarLevel">150</span></p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h4 class="card-title"><i class="fas fa-bullhorn"></i> Clan News</h4>
                        <div class="mt-2" id="sidebarClanNews">
                            <p><strong>Tournament:</strong> Weekly scrims every Friday</p>
                            <p><strong>Recruitment:</strong> Open for active players</p>
                            <p><strong>Event:</strong> Clan war starting soon</p>
                        </div>
                    </div>
                </aside>
                
                <!-- Main Content -->
                <div class="dashboard-content">
                    <!-- Tab Navigation -->
                    <div class="tabs" id="userTabs">
                        <button class="tab active" data-tab="dashboard">Dashboard</button>
                        <button class="tab" data-tab="profile">Profile</button>
                        <button class="tab" data-tab="clan">Clan Info</button>
                        <button class="tab" data-tab="applications">Applications</button>
                        <button class="tab hidden" data-tab="events" id="userEventsTab">Events</button>
                        <button class="tab" data-tab="settings">Settings</button>
                    </div>
                    
                    <!-- Dashboard Tab -->
                    <div class="tab-content active" id="dashboardTab">
                        <h2 class="mb-3">Welcome, <span id="dashboardUsername">Player</span>!</h2>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <i class="fas fa-users fa-2x"></i>
                                <div class="stat-value" id="totalMembers">0</div>
                                <div class="stat-label">Clan Members</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-trophy fa-2x"></i>
                                <div class="stat-value" id="avgMPRank">--</div>
                                <div class="stat-label">Avg MP Rank</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-crosshairs fa-2x"></i>
                                <div class="stat-value" id="avgBRRank">--</div>
                                <div class="stat-label">Avg BR Rank</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-calendar-alt fa-2x"></i>
                                <div class="stat-value" id="clanAge">0</div>
                                <div class="stat-label">Clan Age (Days)</div>
                            </div>
                        </div>
                        
                        <div class="grid mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fas fa-calendar-check"></i> Upcoming Events</h3>
                                </div>
                                <div class="activity-feed" id="upcomingEvents">
                                    <!-- Events will be dynamically added here -->
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fas fa-crown"></i> Top Members</h3>
                                </div>
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Player</th>
                                                <th>MP Rank</th>
                                                <th>Level</th>
                                            </tr>
                                        </thead>
                                        <tbody id="topMembersTable">
                                            <!-- Top members will be dynamically added here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-bullseye"></i> Your Application Status</h3>
                            </div>
                            <div class="card-body">
                                <div id="applicationStatusContainer">
                                    <!-- Application status will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile Tab -->
                    <div class="tab-content" id="profileTab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-user-circle"></i> My Profile</h3>
                                <button class="btn btn-secondary" id="editProfileBtn">
                                    <i class="fas fa-edit"></i> Edit Profile
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="flex-center mb-4">
                                    <img src="" alt="Profile Picture" class="profile-pic-preview" id="profilePicture">
                                </div>
                                
                                <div class="grid">
                                    <div>
                                        <h4 class="mb-2">Account Information</h4>
                                        <p><strong>Username:</strong> <span id="profileUsername">username</span></p>
                                        <p><strong>Status:</strong> <span id="profileStatus" class="badge">Member</span></p>
                                        <p><strong>Join Date:</strong> <span id="profileJoinDate">2023-01-01</span></p>
                                    </div>
                                    
                                    <div>
                                        <h4 class="mb-2">CODM Information</h4>
                                        <p><strong>CODM Name:</strong> <span id="profileCODMName">PlayerName</span></p>
                                        <p><strong>Level:</strong> <span id="profileLevel">150</span></p>
                                        <p><strong>MP Rank:</strong> <span id="profileMPRank">Legendary</span></p>
                                        <p><strong>BR Rank:</strong> <span id="profileBRRank">Legendary</span></p>
                                    </div>
                                    
                                    <div>
                                        <h4 class="mb-2">Personal Information</h4>
                                        <p><strong>Gender:</strong> <span id="profileGender">Male</span></p>
                                        <p><strong>Date of Birth:</strong> <span id="profileDOB">1990-01-01</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Clan Info Tab -->
                    <div class="tab-content" id="clanTab">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-flag"></i> Clan Information</h3>
                            </div>
                            <div class="card-body">
                                <div class="text-center mb-4">
                                    <div class="clan-banner" id="clanBanner" style="height: 150px; background: linear-gradient(to right, #000000, #003300); border-radius: var(--border-radius); margin-bottom: 20px;"></div>
                                    <h2 id="clanNameDisplay">VOIDM - BSQUAD</h2>
                                    <p id="clanTagDisplay" style="color: var(--primary-color); font-size: 1.2rem;">[VOIDM]</p>
                                    <p id="clanDescription" class="mt-2">A competitive Call of Duty: Mobile clan focused on teamwork, strategy, and domination. Join us to participate in tournaments, clan wars, and ranked matches.</p>
                                </div>
                                
                                <h4 class="mb-3"><i class="fas fa-trophy"></i> Clan Statistics</h4>
                                <div class="grid">
                                    <div class="stat-card">
                                        <div class="stat-value" id="clanTotalMembers">0</div>
                                        <div class="stat-label">Total Members</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="clanAvgLevel">0</div>
                                        <div class="stat-label">Average Level</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="clanLegendaryPlayers">0</div>
                                        <div class="stat-label">Legendary Players</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-value" id="clanActiveApplicants">0</div>
                                        <div class="stat-label">Active Applicants</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-users"></i> Clan Members</h3>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Player</th>
                                                <th>CODM Name</th>
                                                <th>Level</th>
                                                <th>MP Rank</th>
                                                <th>Status</th>
                                                <th>Join Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="clanMembersTable">
                                            <!-- Clan members will be dynamically added here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Applications Tab -->
                    <div class="tab-content" id="applicationsTab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-file-alt"></i> My Applications</h3>
                                <button class="btn btn-primary" id="newApplicationBtn">
                                    <i class="fas fa-plus"></i> New Application
                                </button>
                            </div>
                            <div class="card-body">
                                <div id="myApplicationsContainer">
                                    <!-- Applications will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Events Tab (Only for Members) -->
                    <div class="tab-content" id="eventsTab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Clan Events</h3>
                            </div>
                            <div class="card-body">
                                <div id="eventsContainer">
                                    <!-- Events will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Tab -->
                    <div class="tab-content" id="settingsTab">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-user-cog"></i> Account Settings</h3>
                            </div>
                            <div class="card-body">
                                <div class="grid">
                                    <div class="card">
                                        <h4 class="card-title"><i class="fas fa-key"></i> Change Password</h4>
                                        <form id="changePasswordForm">
                                            <div class="form-group">
                                                <label class="form-label" for="currentPassword">Current Password</label>
                                                <input type="password" id="currentPassword" class="form-control" required>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="newPassword">New Password</label>
                                                <input type="password" id="newPassword" class="form-control" required>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="confirmNewPassword">Confirm New Password</label>
                                                <input type="password" id="confirmNewPassword" class="form-control" required>
                                            </div>
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save"></i> Change Password
                                            </button>
                                        </form>
                                    </div>
                                    
                                    <div class="card">
                                        <h4 class="card-title"><i class="fas fa-trash-alt"></i> Danger Zone</h4>
                                        <p class="mb-3">Permanently delete your account and all associated data.</p>
                                        <button class="btn btn-danger" id="deleteAccountBtn">
                                            <i class="fas fa-exclamation-triangle"></i> Delete Account
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-palette"></i> Theme Settings</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="form-label">Accent Color</label>
                                    <input type="color" id="themeColorPicker" value="#00ff00" class="form-control" style="height: 50px; width: 100px;">
                                </div>
                                <button class="btn btn-secondary" id="resetThemeBtn">
                                    <i class="fas fa-undo"></i> Reset to Default
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Dashboard -->
        <section class="container hidden" id="adminPage">
            <div class="dashboard">
                <!-- Admin Sidebar -->
                <aside class="dashboard-sidebar">
                    <div class="card user-info-card">
                        <img src="" alt="Admin Avatar" class="user-avatar" id="adminSidebarAvatar">
                        <h3 class="user-name" id="adminSidebarUsername">Admin</h3>
                        <div class="user-status">
                            <span class="badge badge-success">Administrator</span>
                        </div>
                        <p>Clan Leader</p>
                        <p id="adminSidebarJoinDate">Joined: Jan 2023</p>
                        
                        <div class="mt-3">
                            <button class="btn btn-primary btn-block" id="createEventBtn">
                                <i class="fas fa-calendar-plus"></i> Create Event
                            </button>
                        </div>
                    </div>
                    
                    <div class="card mb-2">
                        <h4 class="card-title"><i class="fas fa-chart-bar"></i> Quick Stats</h4>
                        <div class="mt-2">
                            <p><strong>Pending Apps:</strong> <span id="adminPendingApps">0</span></p>
                            <p><strong>Total Users:</strong> <span id="adminTotalUsers">0</span></p>
                            <p><strong>Active Today:</strong> <span id="adminActiveToday">0</span></p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h4 class="card-title"><i class="fas fa-tasks"></i> Quick Actions</h4>
                        <div class="mt-2 flex-column" style="gap: 10px;">
                            <button class="btn btn-secondary btn-block btn-small" id="viewAllUsersBtn">
                                <i class="fas fa-users"></i> View All Users
                            </button>
                            <button class="btn btn-secondary btn-block btn-small" id="viewActivityLogsBtn">
                                <i class="fas fa-history"></i> Activity Logs
                            </button>
                            <button class="btn btn-secondary btn-block btn-small" id="manageEventsBtn">
                                <i class="fas fa-calendar"></i> Manage Events
                            </button>
                        </div>
                    </div>
                </aside>
                
                <!-- Admin Main Content -->
                <div class="dashboard-content">
                    <!-- Admin Tab Navigation -->
                    <div class="tabs">
                        <button class="tab active" data-tab="adminDashboard">Dashboard</button>
                        <button class="tab" data-tab="adminApplications">Applications</button>
                        <button class="tab" data-tab="adminUsers">User Management</button>
                        <button class="tab" data-tab="adminEvents">Events</button>
                        <button class="tab" data-tab="adminActivity">Activity Logs</button>
                        <button class="tab" data-tab="adminSettings">Settings</button>
                    </div>
                    
                    <!-- Admin Dashboard Tab -->
                    <div class="tab-content active" id="adminDashboardTab">
                        <h2 class="mb-3">Admin Dashboard</h2>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <i class="fas fa-user-plus fa-2x"></i>
                                <div class="stat-value" id="adminNewUsers">0</div>
                                <div class="stat-label">New Users (7 days)</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-file-alt fa-2x"></i>
                                <div class="stat-value" id="adminPendingApplications">0</div>
                                <div class="stat-label">Pending Applications</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-user-check fa-2x"></i>
                                <div class="stat-value" id="adminTotalMembers">0</div>
                                <div class="stat-label">Total Members</div>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-calendar-alt fa-2x"></i>
                                <div class="stat-value" id="adminUpcomingEvents">0</div>
                                <div class="stat-label">Upcoming Events</div>
                            </div>
                        </div>
                        
                        <div class="grid mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fas fa-history"></i> Recent Activity</h3>
                                </div>
                                <div class="activity-feed" id="adminRecentActivity">
                                    <!-- Admin activity items will be dynamically added here -->
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="card-title"><i class="fas fa-chart-pie"></i> Member Distribution</h3>
                                </div>
                                <div class="card-body">
                                    <div id="memberDistributionChart">
                                        <!-- Simple text-based chart for now -->
                                        <p><strong>Members:</strong> <span id="distMembers">0</span></p>
                                        <p><strong>Applicants:</strong> <span id="distApplicants">0</span></p>
                                        <p><strong>Pending:</strong> <span id="distPending">0</span></p>
                                        <p><strong>Admins:</strong> <span id="distAdmins">0</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-bell"></i> Recent Notifications</h3>
                            </div>
                            <div class="card-body">
                                <div id="adminNotificationsContainer">
                                    <!-- Notifications will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Applications Tab -->
                    <div class="tab-content" id="adminApplicationsTab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-file-alt"></i> Clan Applications</h3>
                                <div class="flex" style="gap: 10px;">
                                    <button class="btn btn-secondary" id="filterPendingBtn">
                                        <i class="fas fa-clock"></i> Pending
                                    </button>
                                    <button class="btn btn-secondary" id="filterAllBtn">
                                        <i class="fas fa-list"></i> All
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Applicant</th>
                                                <th>CODM Name</th>
                                                <th>Level</th>
                                                <th>MP Rank</th>
                                                <th>Experience</th>
                                                <th>Status</th>
                                                <th>Date</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="adminApplicationsTable">
                                            <!-- Applications will be dynamically added here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Users Tab -->
                    <div class="tab-content" id="adminUsersTab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-users-cog"></i> User Management</h3>
                                <button class="btn btn-primary" id="addNewUserBtn">
                                    <i class="fas fa-user-plus"></i> Add User
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Username</th>
                                                <th>CODM Name</th>
                                                <th>Level</th>
                                                <th>Status</th>
                                                <th>Join Date</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="adminUsersTable">
                                            <!-- Users will be dynamically added here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Events Tab -->
                    <div class="tab-content" id="adminEventsTab">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-calendar-plus"></i> Create New Event</h3>
                            </div>
                            <div class="card-body">
                                <form id="createEventForm">
                                    <div class="grid">
                                        <div class="form-group">
                                            <label class="form-label" for="eventTitle">Event Title *</label>
                                            <input type="text" id="eventTitle" class="form-control" placeholder="Tournament, Scrims, Practice, etc." required>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="eventDate">Event Date *</label>
                                            <input type="datetime-local" id="eventDate" class="form-control" required>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="eventType">Event Type</label>
                                        <select id="eventType" class="form-control form-select">
                                            <option value="Tournament">Tournament</option>
                                            <option value="Scrimmage">Scrimmage</option>
                                            <option value="Practice">Practice Session</option>
                                            <option value="Meeting">Clan Meeting</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="eventDescription">Event Description *</label>
                                        <textarea id="eventDescription" class="form-control" rows="4" placeholder="Describe the event details, rules, requirements..." required></textarea>
                                    </div>
                                    
                                    <div class="grid">
                                        <div class="form-group">
                                            <label class="form-label" for="eventMaxPlayers">Max Players</label>
                                            <input type="number" id="eventMaxPlayers" class="form-control" min="1" max="100" value="10">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="eventPriority">Priority</label>
                                            <select id="eventPriority" class="form-control form-select">
                                                <option value="low">Low</option>
                                                <option value="normal" selected>Normal</option>
                                                <option value="high">High</option>
                                                <option value="urgent">Urgent</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <input type="checkbox" id="sendNotification" checked>
                                        <label for="sendNotification">Send notification to all members</label>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-calendar-plus"></i> Create Event
                                    </button>
                                </form>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Manage Events</h3>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Title</th>
                                                <th>Type</th>
                                                <th>Date</th>
                                                <th>Priority</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="adminEventsTable">
                                            <!-- Events will be dynamically added here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Activity Tab -->
                    <div class="tab-content" id="adminActivityTab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-history"></i> Activity Logs</h3>
                                <div class="flex" style="gap: 10px;">
                                    <button class="btn btn-secondary" id="exportLogsBtn">
                                        <i class="fas fa-download"></i> Export Logs
                                    </button>
                                    <button class="btn btn-danger" id="clearLogsBtn">
                                        <i class="fas fa-trash"></i> Clear Logs
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="activity-feed" id="adminActivityLogs">
                                    <!-- Activity logs will be dynamically added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Settings Tab -->
                    <div class="tab-content" id="adminSettingsTab">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-flag"></i> Clan Settings</h3>
                            </div>
                            <div class="card-body">
                                <form id="clanSettingsForm">
                                    <div class="grid">
                                        <div class="form-group">
                                            <label class="form-label" for="clanNameInput">Clan Name</label>
                                            <input type="text" id="clanNameInput" class="form-control" value="VOIDM - BSQUAD">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="clanTagInput">Clan Tag</label>
                                            <input type="text" id="clanTagInput" class="form-control" value="[VOIDM]" maxlength="10">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="clanDescriptionInput">Clan Description</label>
                                        <textarea id="clanDescriptionInput" class="form-control" rows="3">A competitive Call of Duty: Mobile clan focused on teamwork, strategy, and domination. Join us to participate in tournaments, clan wars, and ranked matches.</textarea>
                                    </div>
                                    
                                    <div class="grid">
                                        <div class="form-group">
                                            <label class="form-label" for="clanLogoUpload">Clan Logo</label>
                                            <input type="file" id="clanLogoUpload" class="form-control" accept="image/*">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="clanBannerColor">Banner Color</label>
                                            <input type="color" id="clanBannerColor" value="#000000" class="form-control" style="height: 50px;">
                                        </div>
                                    </div>
                                    
                                    <div class="grid">
                                        <div class="form-group">
                                            <label class="form-label" for="clanCreationDate">Clan Creation Date</label>
                                            <input type="date" id="clanCreationDate" class="form-control" value="2023-01-01">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="registrationStatus">Registration Status</label>
                                            <select id="registrationStatus" class="form-control form-select">
                                                <option value="open">Open</option>
                                                <option value="closed">Closed</option>
                                                <option value="invite">Invite Only</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary mt-2">
                                        <i class="fas fa-save"></i> Save Clan Settings
                                    </button>
                                </form>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-globe"></i> Website Settings</h3>
                            </div>
                            <div class="card-body">
                                <form id="websiteSettingsForm">
                                    <div class="grid">
                                        <div class="form-group">
                                            <label class="form-label" for="websiteNameInput">Website Name</label>
                                            <input type="text" id="websiteNameInput" class="form-control" value="VOIDM - BSQUAD">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="websiteTheme">Theme</label>
                                            <select id="websiteTheme" class="form-control form-select">
                                                <option value="cyberpunk">Cyberpunk (Green/Black)</option>
                                                <option value="dark">Dark</option>
                                                <option value="blue">Blue</option>
                                                <option value="red">Red</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="whatsappNumber">WhatsApp Contact</label>
                                        <input type="text" id="whatsappNumber" class="form-control" placeholder="+1234567890">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label" for="autoApproveLevel">Auto-Approve Minimum Level</label>
                                        <input type="number" id="autoApproveLevel" class="form-control" min="1" max="400" value="100">
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary mt-2">
                                        <i class="fas fa-save"></i> Save Website Settings
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    
    <!-- Forgot Password Modal -->
    <div class="modal-overlay" id="forgotPasswordModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-key"></i> Password Recovery</h3>
                <button class="modal-close" data-modal="forgotPasswordModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>To reset your password, please enter your username and date of birth.</p>
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label class="form-label" for="recoveryUsername">Username</label>
                        <input type="text" id="recoveryUsername" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="recoveryDOB">Date of Birth</label>
                        <input type="date" id="recoveryDOB" class="form-control" required>
                    </div>
                </form>
                <p class="mt-3"><small>If your information is correct, your password will be displayed on screen. Please change it immediately after logging in.</small></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="forgotPasswordModal">Cancel</button>
                <button class="btn btn-primary" id="recoverPasswordBtn">Recover Password</button>
            </div>
        </div>
    </div>
    
    <!-- Application Modal -->
    <div class="modal-overlay" id="applicationModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title"><i class="fas fa-file-alt"></i> Clan Application</h3>
                <button class="modal-close" data-modal="applicationModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="applicationForm">
                    <div class="form-group">
                        <label class="form-label" for="appExperience">Years of CODM Experience</label>
                        <select id="appExperience" class="form-control form-select" required>
                            <option value="">Select Experience</option>
                            <option value="1">Less than 1 year</option>
                            <option value="2">1-2 years</option>
                            <option value="3">2-3 years</option>
                            <option value="4">3+ years</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="appPlaystyle">Preferred Playstyle</label>
                            <select id="appPlaystyle" class="form-control form-select" required>
                                <option value="">Select Playstyle</option>
                                <option value="Aggressive">Aggressive</option>
                                <option value="Defensive">Defensive</option>
                                <option value="Support">Support</option>
                                <option value="Sniper">Sniper</option>
                                <option value="Flex">Flexible</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="appAvailability">Weekly Availability (hours)</label>
                            <input type="number" id="appAvailability" class="form-control" min="1" max="40" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Do you have a microphone?</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="microphone" value="Yes" checked>
                                    Yes
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="microphone" value="No">
                                    No
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="appReason">Why do you want to join our clan?</label>
                            <textarea id="appReason" class="form-control" rows="4" required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="applicationModal">Cancel</button>
                    <button class="btn btn-primary" id="submitApplicationBtn">Submit Application</button>
                </div>
            </div>
        </div>
        
        <!-- View Application Modal -->
        <div class="modal-overlay" id="viewApplicationModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-file-alt"></i> Application Details</h3>
                    <button class="modal-close" data-modal="viewApplicationModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="applicationDetails">
                        <!-- Application details will be dynamically added here -->
                    </div>
                </div>
                <div class="modal-footer" id="applicationModalFooter">
                    <!-- Buttons will be dynamically added here -->
                </div>
            </div>
        </div>
        
        <!-- Edit Profile Modal -->
        <div class="modal-overlay" id="editProfileModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-user-edit"></i> Edit Profile</h3>
                    <button class="modal-close" data-modal="editProfileModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="editProfileForm">
                        <div class="form-group">
                            <label class="form-label" for="editUsername">Username *</label>
                            <input type="text" id="editUsername" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="editCODMName">CODM In-Game Name *</label>
                            <input type="text" id="editCODMName" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="editLevel">Player Level *</label>
                            <input type="number" id="editLevel" class="form-control" min="1" max="400" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="editMPRank">MP Rank</label>
                            <select id="editMPRank" class="form-control form-select" required>
                                <option value="Rookie">Rookie</option>
                                <option value="Veteran">Veteran</option>
                                <option value="Elite">Elite</option>
                                <option value="Pro">Pro</option>
                                <option value="Master">Master</option>
                                <option value="Grandmaster">Grandmaster</option>
                                <option value="Legendary">Legendary</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="editBRRank">BR Rank</label>
                            <select id="editBRRank" class="form-control form-select" required>
                                <option value="Rookie">Rookie</option>
                                <option value="Veteran">Veteran</option>
                                <option value="Elite">Elite</option>
                                <option value="Pro">Pro</option>
                                <option value="Master">Master</option>
                                <option value="Grandmaster">Grandmaster</option>
                                <option value="Legendary">Legendary</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="editGender">Gender</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="editGender" value="Male">
                                    Male
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="editGender" value="Female">
                                    Female
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="editGender" value="Other">
                                    Other
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="editDOB">Date of Birth</label>
                            <input type="date" id="editDOB" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Profile Picture</label>
                            <div class="file-upload">
                                <input type="file" id="editProfilePic" accept="image/*">
                                <label for="editProfilePic" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <span>Click to upload new profile picture</span>
                                </label>
                            </div>
                            <div class="text-center mt-2">
                                <img src="" alt="Preview" class="profile-pic-preview" id="editProfilePicPreview">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="editProfileModal">Cancel</button>
                    <button class="btn btn-primary" id="saveProfileBtn">Save Changes</button>
                </div>
            </div>
        </div>
        
        <!-- Confirm Delete Account Modal -->
        <div class="modal-overlay" id="deleteAccountModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Confirm Account Deletion</h3>
                    <button class="modal-close" data-modal="deleteAccountModal">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete your account? This action cannot be undone.</p>
                    <p class="text-danger"><strong>Warning:</strong> All your data, including profile, applications, and activity will be permanently deleted.</p>
                    <div class="form-group mt-3">
                        <label class="form-label" for="confirmDeletePassword">Enter your password to confirm:</label>
                        <input type="password" id="confirmDeletePassword" class="form-control" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="deleteAccountModal">Cancel</button>
                    <button class="btn btn-danger" id="confirmDeleteAccountBtn">Delete Account</button>
                </div>
            </div>
        </div>
        
        <!-- Admin: View User Modal -->
        <div class="modal-overlay" id="adminViewUserModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-user"></i> User Details</h3>
                    <button class="modal-close" data-modal="adminViewUserModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="adminUserDetails">
                        <!-- User details will be dynamically added here -->
                    </div>
                </div>
                <div class="modal-footer" id="adminUserModalFooter">
                    <!-- Buttons will be dynamically added here -->
                </div>
            </div>
        </div>
        
        <!-- Admin: Add User Modal -->
        <div class="modal-overlay" id="adminAddUserModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-user-plus"></i> Add New User</h3>
                    <button class="modal-close" data-modal="adminAddUserModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="adminAddUserForm">
                        <div class="form-group">
                            <label class="form-label" for="adminAddUsername">Username *</label>
                            <input type="text" id="adminAddUsername" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminAddPassword">Password *</label>
                            <input type="password" id="adminAddPassword" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminAddCODMName">CODM In-Game Name *</label>
                            <input type="text" id="adminAddCODMName" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminAddLevel">Level *</label>
                            <input type="number" id="adminAddLevel" class="form-control" min="1" max="400" value="1" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminAddStatus">User Status *</label>
                            <select id="adminAddStatus" class="form-control form-select" required>
                                <option value="Applicant">Applicant</option>
                                <option value="Pending">Pending</option>
                                <option value="Member">Member</option>
                                <option value="Admin">Admin</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="adminAddUserModal">Cancel</button>
                    <button class="btn btn-primary" id="adminAddUserBtn">Add User</button>
                </div>
            </div>
        </div>
        
        <!-- Admin: Edit User Modal -->
        <div class="modal-overlay" id="adminEditUserModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-user-edit"></i> Edit User</h3>
                    <button class="modal-close" data-modal="adminEditUserModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="adminEditUserForm">
                        <input type="hidden" id="adminEditUserId">
                        <div class="form-group">
                            <label class="form-label" for="adminEditUsername">Username *</label>
                            <input type="text" id="adminEditUsername" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminEditCODMName">CODM In-Game Name *</label>
                            <input type="text" id="adminEditCODMName" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminEditLevel">Player Level *</label>
                            <input type="number" id="adminEditLevel" class="form-control" min="1" max="400" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminEditMPRank">MP Rank</label>
                            <select id="adminEditMPRank" class="form-control form-select" required>
                                <option value="Rookie">Rookie</option>
                                <option value="Veteran">Veteran</option>
                                <option value="Elite">Elite</option>
                                <option value="Pro">Pro</option>
                                <option value="Master">Master</option>
                                <option value="Grandmaster">Grandmaster</option>
                                <option value="Legendary">Legendary</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminEditBRRank">BR Rank</label>
                            <select id="adminEditBRRank" class="form-control form-select" required>
                                <option value="Rookie">Rookie</option>
                                <option value="Veteran">Veteran</option>
                                <option value="Elite">Elite</option>
                                <option value="Pro">Pro</option>
                                <option value="Master">Master</option>
                                <option value="Grandmaster">Grandmaster</option>
                                <option value="Legendary">Legendary</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminEditStatus">User Status *</label>
                            <select id="adminEditStatus" class="form-control form-select" required>
                                <option value="Applicant">Applicant</option>
                                <option value="Pending">Pending</option>
                                <option value="Member">Member</option>
                                <option value="Admin">Admin</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="adminEditIsAdmin">Is Administrator</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="adminEditIsAdmin" value="true"> Yes
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="adminEditIsAdmin" value="false" checked> No
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="adminEditUserModal">Cancel</button>
                    <button class="btn btn-primary" id="adminSaveUserBtn">Save Changes</button>
                </div>
            </div>
        </div>
        
        <!-- View Event Modal -->
        <div class="modal-overlay" id="viewEventModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-calendar-alt"></i> Event Details</h3>
                    <button class="modal-close" data-modal="viewEventModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="eventDetails">
                        <!-- Event details will be dynamically added here -->
                    </div>
                </div>
                <div class="modal-footer" id="eventModalFooter">
                    <!-- Buttons will be dynamically added here -->
                </div>
            </div>
        </div>
        
        <!-- WhatsApp Contact Modal -->
        <div class="modal-overlay" id="whatsappModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fab fa-whatsapp"></i> Contact Admin</h3>
                    <button class="modal-close" data-modal="whatsappModal">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Contact the clan admin via WhatsApp for:</p>
                    <ul>
                        <li>Feature requests</li>
                        <li>Bug reports</li>
                        <li>General inquiries</li>
                        <li>Emergency issues</li>
                    </ul>
                    <div class="form-group mt-3">
                        <label class="form-label" for="whatsappMessage">Your Message</label>
                        <textarea id="whatsappMessage" class="form-control" rows="4" placeholder="Describe your issue or feature request..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-modal="whatsappModal">Cancel</button>
                    <a href="#" class="btn btn-success" id="sendWhatsappBtn" target="_blank">
                        <i class="fab fa-whatsapp"></i> Send via WhatsApp
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Toast Notifications Container -->
        <div class="toast-container" id="toastContainer"></div>
        
        <!-- WhatsApp Floating Button -->
        <div class="whatsapp-button" id="whatsappButton">
            <i class="fab fa-whatsapp"></i>
        </div>

        <script>
            // ============================================
            // DATABASE SERVER SIMULATION
            // ============================================
            
            // Simulating a database server with localStorage
            class DatabaseServer {
                constructor() {
                    this.dbName = 'voidm_clan_db';
                    this.initDatabase();
                }
                
                initDatabase() {
                    if (!localStorage.getItem(this.dbName)) {
                        const initialData = {
                            users: this.getDefaultUsers(),
                            applications: this.getDefaultApplications(),
                            activityLogs: this.getDefaultActivityLogs(),
                            clanSettings: this.getDefaultClanSettings(),
                            websiteSettings: this.getDefaultWebsiteSettings(),
                            events: this.getDefaultEvents(),
                            notifications: {}
                        };
                        this.saveAllData(initialData);
                    }
                }
                
                getDefaultUsers() {
                    return [
                        {
                            id: 1,
                            username: "admin",
                            password: "admin123",
                            codmName: "VOIDM_Leader",
                            level: 350,
                            mpRank: "Legendary",
                            brRank: "Legendary",
                            gender: "Male",
                            dob: "1990-05-15",
                            status: "Admin",
                            isAdmin: true,
                            joinDate: "2025-01-01",
                            profilePic: "",
                            notifications: []
                        },
                        {
                            id: 2,
                            username: "player1",
                            password: "test123",
                            codmName: "CODM_Pro",
                            level: 380,
                            mpRank: "Legendary",
                            brRank: "Grandmaster",
                            gender: "Male",
                            dob: "1995-08-22",
                            status: "Member",
                            isAdmin: false,
                            joinDate: "2025-02-15",
                            profilePic: "",
                            notifications: [
                                { id: 1, message: "Welcome to VOIDM - BSQUAD!", timestamp: "2025-02-15 10:30:00", read: true },
                                { id: 2, message: "Your application has been accepted!", timestamp: "2025-02-20 14:15:00", read: true }
                            ]
                        }
                    ];
                }
                
                getDefaultApplications() {
                    return [
                        {
                            id: 1,
                            userId: 2,
                            username: "player1",
                            codmName: "CODM_Pro",
                            level: 400,
                            ranks: "MP: Legendary, BR: Grandmaster",
                            experience: 3,
                            playstyle: "Aggressive",
                            availability: 15,
                            microphone: "Yes",
                            reason: "Looking for a competitive clan to participate in tournaments and improve my skills.",
                            status: "Accepted",
                            date: "2025-02-18"
                        }
                    ];
                }
                
                getDefaultActivityLogs() {
                    return [
                        { id: 1, user: "admin", action: "System initialized", timestamp: "2023-01-01 00:00:00" },
                        { id: 2, user: "player1", action: "User registered", timestamp: "2023-02-15 10:30:00" },
                        { id: 3, user: "player1", action: "Submitted clan application", timestamp: "2023-02-18 14:20:00" },
                        { id: 4, user: "admin", action: "Accepted application from player1", timestamp: "2023-02-20 14:15:00" }
                    ];
                }
                
                getDefaultClanSettings() {
                    return {
                        id: 1,
                        clanName: "VOIDM - BSQUAD",
                        clanTag: "[V-]",
                        clanDescription: "A competitive Call of Duty: Mobile clan focused on teamwork, strategy, and domination. Join us to participate in tournaments, clan wars, and ranked matches.",
                        clanLogo: "",
                        bannerColor: "#000000",
                        creationDate: "2023-01-01",
                        registrationStatus: "open"
                    };
                }
                
                getDefaultWebsiteSettings() {
                    return {
                        id: 1,
                        websiteName: "VOIDM - BSQUAD",
                        theme: "cyberpunk",
                        whatsappNumber: "",
                        autoApproveLevel: 100
                    };
                }
                
                getDefaultEvents() {
                    return [
                        {
                            id: 1,
                            title: "Weekly Tournament",
                            type: "Tournament",
                            description: "Weekly clan tournament with prize pool. All members must participate.",
                            date: new Date(Date.now() + 86400000).toISOString(), // Tomorrow
                            createdBy: "admin",
                            createdAt: new Date().toISOString(),
                            maxPlayers: 20,
                            priority: "high",
                            status: "upcoming",
                            participants: []
                        },
                        {
                            id: 2,
                            title: "Practice Session",
                            type: "Practice",
                            description: "Team practice for upcoming tournament. Focus on strategy and coordination.",
                            date: new Date(Date.now() + 172800000).toISOString(), // Day after tomorrow
                            createdBy: "admin",
                            createdAt: new Date().toISOString(),
                            maxPlayers: 15,
                            priority: "normal",
                            status: "upcoming",
                            participants: []
                        }
                    ];
                }
                
                getAllData() {
                    const data = localStorage.getItem(this.dbName);
                    return data ? JSON.parse(data) : {};
                }
                
                saveAllData(data) {
                    localStorage.setItem(this.dbName, JSON.stringify(data));
                    window.dispatchEvent(new Event('databaseUpdated'));
                }
                
                // User operations
                getUsers() {
                    return this.getAllData().users || [];
                }
                
                saveUsers(users) {
                    const data = this.getAllData();
                    data.users = users;
                    this.saveAllData(data);
                }
                
                // Application operations
                getApplications() {
                    return this.getAllData().applications || [];
                }
                
                saveApplications(applications) {
                    const data = this.getAllData();
                    data.applications = applications;
                    this.saveAllData(data);
                }
                
                // Activity log operations
                getActivityLogs() {
                    return this.getAllData().activityLogs || [];
                }
                
                saveActivityLogs(logs) {
                    const data = this.getAllData();
                    data.activityLogs = logs;
                    this.saveAllData(data);
                }
                
                // Clan settings operations
                getClanSettings() {
                    return this.getAllData().clanSettings || this.getDefaultClanSettings();
                }
                
                saveClanSettings(settings) {
                    const data = this.getAllData();
                    data.clanSettings = settings;
                    this.saveAllData(data);
                }
                
                // Website settings operations
                getWebsiteSettings() {
                    return this.getAllData().websiteSettings || this.getDefaultWebsiteSettings();
                }
                
                saveWebsiteSettings(settings) {
                    const data = this.getAllData();
                    data.websiteSettings = settings;
                    this.saveAllData(data);
                }
                
                // Event operations
                getEvents() {
                    return this.getAllData().events || this.getDefaultEvents();
                }
                
                saveEvents(events) {
                    const data = this.getAllData();
                    data.events = events;
                    this.saveAllData(data);
                }
                
                // Generate IDs
                generateId(items) {
                    if (!items || items.length === 0) return 1;
                    return Math.max(...items.map(item => item.id)) + 1;
                }
                
                // Encryption for passwords (basic)
                encryptPassword(password) {
                    return btoa(password + 'VOIDM_SALT_2024');
                }
                
                decryptPassword(encrypted) {
                    try {
                        return atob(encrypted).replace('VOIDM_SALT_2024', '');
                    } catch {
                        return encrypted;
                    }
                }
            }
            
            // ============================================
            // INITIALIZE DATABASE
            // ============================================
            
            const db = new DatabaseServer();
            
            // ============================================
            // DATA MANAGEMENT FUNCTIONS
            // ============================================
            
            // LocalStorage Keys
            const STORAGE_KEYS = {
                CURRENT_USER: 'voidm_bsquad_current_user',
                SHOW_EVENT_ANNOUNCEMENT: 'voidm_show_event_announcement'
            };
            
            // Data CRUD Operations using Database Server
            function getUsers() {
                return db.getUsers();
            }
            
            function getApplications() {
                return db.getApplications();
            }
            
            function getActivityLogs() {
                return db.getActivityLogs();
            }
            
            function getClanSettings() {
                return db.getClanSettings();
            }
            
            function getWebsiteSettings() {
                return db.getWebsiteSettings();
            }
            
            function getEvents() {
                return db.getEvents();
            }
            
            function getCurrentUser() {
                const userData = localStorage.getItem(STORAGE_KEYS.CURRENT_USER);
                return userData ? JSON.parse(userData) : null;
            }
            
            // Save functions
            function saveUsers(users) {
                db.saveUsers(users);
            }
            
            function saveApplications(applications) {
                db.saveApplications(applications);
            }
            
            function saveActivityLogs(logs) {
                db.saveActivityLogs(logs);
            }
            
            function saveClanSettingsData(settings) {
                db.saveClanSettings(settings);
            }
            
            function saveWebsiteSettings(settings) {
                db.saveWebsiteSettings(settings);
            }
            
            function saveEvents(events) {
                db.saveEvents(events);
            }
            
            function saveCurrentUser(user) {
                localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(user));
            }
            
            function clearCurrentUser() {
                localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
            }
            
            // ============================================
            // UTILITY FUNCTIONS
            // ============================================
            
            // Format Date
            function formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
            }
            
            function formatDateTime(dateTimeString) {
                const date = new Date(dateTimeString);
                return date.toLocaleString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
            
            // Calculate Days Since
            function daysSince(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diffTime = Math.abs(now - date);
                return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            }
            
            // Show Toast Notification
            function showToast(message, type = 'info') {
                const toastContainer = document.getElementById('toastContainer');
                const toastId = 'toast-' + Date.now();
                
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                toast.id = toastId;
                
                toast.innerHTML = `
                    <div>
                        <strong>${type.charAt(0).toUpperCase() + type.slice(1)}!</strong>
                        <div>${message}</div>
                    </div>
                    <button class="toast-close" onclick="document.getElementById('${toastId}').remove()">&times;</button>
                `;
                
                toastContainer.appendChild(toast);
                
                // Show toast
                setTimeout(() => {
                    toast.classList.add('show');
                }, 10);
                
                // Auto remove after 5 seconds
                setTimeout(() => {
                    if (document.getElementById(toastId)) {
                        toast.classList.remove('show');
                        setTimeout(() => {
                            if (document.getElementById(toastId)) {
                                document.getElementById(toastId).remove();
                            }
                        }, 300);
                    }
                }, 5000);
            }
            
            // Add Activity Log
            function addActivityLog(user, action) {
                const logs = getActivityLogs();
                const newLog = {
                    id: db.generateId(logs),
                    user: user,
                    action: action,
                    timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19)
                };
                
                logs.unshift(newLog);
                saveActivityLogs(logs);
                
                // Update UI if on admin page
                if (document.getElementById('adminPage') && !document.getElementById('adminPage').classList.contains('hidden')) {
                    loadAdminActivityLogs();
                }
            }
            
            // Add Notification to User
            function addNotification(userId, message) {
                const users = getUsers();
                const user = users.find(u => u.id === userId);
                
                if (user) {
                    if (!user.notifications) user.notifications = [];
                    
                    const newNotification = {
                        id: user.notifications.length > 0 ? Math.max(...user.notifications.map(n => n.id)) + 1 : 1,
                        message: message,
                        timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19),
                        read: false
                    };
                    
                    user.notifications.unshift(newNotification);
                    saveUsers(users);
                    
                    // Update notification badge if current user
                    const currentUser = getCurrentUser();
                    if (currentUser && currentUser.id === userId) {
                        updateNotificationBadge();
                    }
                    
                    return true;
                }
                
                return false;
            }
            
            // Update Notification Badge
            function updateNotificationBadge() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const users = getUsers();
                const user = users.find(u => u.id === currentUser.id);
                
                if (user && user.notifications) {
                    const unreadCount = user.notifications.filter(n => !n.read).length;
                    const badge = document.getElementById('notificationBadge');
                    
                    if (unreadCount > 0) {
                        badge.textContent = unreadCount;
                        badge.classList.remove('hidden');
                    } else {
                        badge.classList.add('hidden');
                    }
                }
            }
            
            // Mark Notifications as Read
            function markNotificationsAsRead(userId) {
                const users = getUsers();
                const user = users.find(u => u.id === userId);
                
                if (user && user.notifications) {
                    user.notifications.forEach(notification => {
                        notification.read = true;
                    });
                    
                    saveUsers(users);
                    updateNotificationBadge();
                    
                    // Update notification dropdown
                    loadNotifications();
                }
            }
            
            // Load Notifications
            function loadNotifications() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const users = getUsers();
                const user = users.find(u => u.id === currentUser.id);
                const notificationList = document.getElementById('notificationList');
                
                if (!notificationList) return;
                
                if (!user || !user.notifications || user.notifications.length === 0) {
                    notificationList.innerHTML = '<div class="notification-item text-center" style="color: var(--text-secondary);">No notifications</div>';
                    return;
                }
                
                notificationList.innerHTML = '';
                
                user.notifications.slice(0, 10).forEach(notification => {
                    const notificationItem = document.createElement('div');
                    notificationItem.className = `notification-item ${notification.read ? '' : 'unread'}`;
                    notificationItem.innerHTML = `
                        <div>${notification.message}</div>
                        <div class="activity-time">${formatDateTime(notification.timestamp)}</div>
                    `;
                    
                    notificationItem.addEventListener('click', () => {
                        // Mark as read when clicked
                        if (!notification.read) {
                            notification.read = true;
                            saveUsers(users);
                            updateNotificationBadge();
                            notificationItem.classList.remove('unread');
                        }
                    });
                    
                    notificationList.appendChild(notificationItem);
                });
            }
            
            // Validate Password
            function validatePassword(password) {
                if (password.length < 6) {
                    return "Password must be at least 6 characters long";
                }
                return null;
            }
            
            // Validate Username
            function validateUsername(username) {
                const users = getUsers();
                
                if (username.length < 3) {
                    return "Username must be at least 3 characters long";
                }
                
                if (users.some(user => user.username === username)) {
                    return "Username already exists";
                }
                
                return null;
            }
            
            // Get Rank Numeric Value for Comparison
            function getRankValue(rank) {
                const ranks = {
                    'Rookie': 1,
                    'Veteran': 2,
                    'Elite': 3,
                    'Pro': 4,
                    'Master': 5,
                    'Grandmaster': 6,
                    'Legendary': 7
                };
                
                return ranks[rank] || 0;
            }
            
            // Get Rank from Numeric Value
            function getRankFromValue(value) {
                const ranks = [
                    'Rookie',
                    'Veteran',
                    'Elite',
                    'Pro',
                    'Master',
                    'Grandmaster',
                    'Legendary'
                ];
                
                return ranks[value - 1] || 'Rookie';
            }
            
            // Show Event Announcement
            function showEventAnnouncement(eventTitle, eventDescription) {
                const announcement = document.getElementById('eventAnnouncement');
                const message = document.getElementById('eventAnnouncementMessage');
                
                message.innerHTML = `
                    <strong> New Clan Event!</strong>
                    <div>${eventTitle} - ${eventDescription.substring(0, 100)}${eventDescription.length > 100 ? '...' : ''}</div>
                `;
                
                announcement.style.display = 'block';
                
                // Save that announcement was shown
                localStorage.setItem(STORAGE_KEYS.SHOW_EVENT_ANNOUNCEMENT, 'true');
            }
            
            // Check for new events on login
            function checkNewEvents() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                // Only show for members
                if (currentUser.status !== 'Member' && currentUser.status !== 'Admin') return;
                
                const events = getEvents();
                const recentEvents = events.filter(event => {
                    const eventDate = new Date(event.createdAt);
                    const now = new Date();
                    const diffHours = (now - eventDate) / (1000 * 60 * 60);
                    return diffHours < 24; // Events created in last 24 hours
                });
                
                if (recentEvents.length > 0) {
                    const latestEvent = recentEvents[0];
                    showEventAnnouncement(latestEvent.title, latestEvent.description);
                }
            }
            
            // ============================================
            // UI MANAGEMENT FUNCTIONS
            // ============================================
            
            // Show/Hide Pages
            function showPage(pageId) {
                // Hide all pages
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('registerPage').classList.add('hidden');
                document.getElementById('dashboardPage').classList.add('hidden');
                document.getElementById('adminPage').classList.add('hidden');
                
                // Show header only if not on login/register pages
                if (pageId === 'loginPage' || pageId === 'registerPage') {
                    document.getElementById('mainHeader').classList.add('hidden');
                } else {
                    document.getElementById('mainHeader').classList.remove('hidden');
                }
                
                // Show requested page
                document.getElementById(pageId).classList.remove('hidden');
                
                // Load data for the page
                if (pageId === 'dashboardPage') {
                    loadUserDashboard();
                } else if (pageId === 'adminPage') {
                    loadAdminDashboard();
                }
            }
            
            // Show/Hide Modals
            function showModal(modalId) {
                document.getElementById(modalId).classList.add('active');
            }
            
            function hideModal(modalId) {
                document.getElementById(modalId).classList.remove('active');
            }
            
            // Initialize Modals
            function initModals() {
                // Close modal when clicking on overlay
                document.querySelectorAll('.modal-overlay').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            modal.classList.remove('active');
                        }
                    });
                });
                
                // Close modal when clicking on close button
                document.querySelectorAll('.modal-close').forEach(button => {
                    button.addEventListener('click', function() {
                        const modalId = this.getAttribute('data-modal');
                        hideModal(modalId);
                    });
                });
                
                // Close modal when clicking on cancel buttons
                document.querySelectorAll('button[data-modal]').forEach(button => {
                    if (button.getAttribute('data-modal')) {
                        button.addEventListener('click', function() {
                            const modalId = this.getAttribute('data-modal');
                            hideModal(modalId);
                        });
                    }
                });
            }
            
            // Initialize Tabs
            function initTabs() {
                // Tab switching for user dashboard
                document.querySelectorAll('.tab[data-tab]').forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabId = this.getAttribute('data-tab');
                        
                        // Update active tab
                        this.closest('.tabs').querySelectorAll('.tab').forEach(t => {
                            t.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        // Show corresponding content
                        const container = this.closest('.dashboard-content') || this.closest('.dashboard-content');
                        if (container) {
                            container.querySelectorAll('.tab-content').forEach(content => {
                                content.classList.remove('active');
                            });
                            
                            const tabContent = container.querySelector(`#${tabId}Tab`);
                            if (tabContent) {
                                tabContent.classList.add('active');
                            }
                        }
                        
                        // Load data for the tab if needed
                        if (tabId === 'dashboard') {
                            loadDashboardData();
                        } else if (tabId === 'profile') {
                            loadUserProfile();
                        } else if (tabId === 'clan') {
                            loadClanInfo();
                        } else if (tabId === 'applications') {
                            loadUserApplications();
                        } else if (tabId === 'events') {
                            loadUserEvents();
                        }
                        
                        // For admin tabs
                        if (tabId === 'adminDashboard') {
                            loadAdminDashboardData();
                        } else if (tabId === 'adminApplications') {
                            loadAdminApplications();
                        } else if (tabId === 'adminUsers') {
                            loadAdminUsers();
                        } else if (tabId === 'adminEvents') {
                            loadAdminEvents();
                        } else if (tabId === 'adminActivity') {
                            loadAdminActivityLogs();
                        } else if (tabId === 'adminSettings') {
                            loadAdminSettings();
                        }
                    });
                });
            }
            
            // Toggle Password Visibility
            function initPasswordToggles() {
                // Login password toggle
                document.getElementById('toggleLoginPassword')?.addEventListener('click', function() {
                    const passwordInput = document.getElementById('loginPassword');
                    const icon = this.querySelector('i');
                    
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        passwordInput.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
                
                // Registration password toggle
                document.getElementById('toggleRegPassword')?.addEventListener('click', function() {
                    const passwordInput = document.getElementById('regPassword');
                    const icon = this.querySelector('i');
                    
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        passwordInput.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            }
            
            // Profile Picture Preview
            function initProfilePicturePreview() {
                // Registration profile picture preview
                document.getElementById('regProfilePic')?.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // Validate file size (2MB max)
                        if (file.size > 2 * 1024 * 1024) {
                            showToast('File size must be less than 2MB', 'error');
                            this.value = '';
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const preview = document.getElementById('profilePicPreview');
                            preview.src = event.target.result;
                            preview.classList.remove('hidden');
                        };
                        reader.readAsDataURL(file);
                    }
                });
                
                // Edit profile picture preview
                document.getElementById('editProfilePic')?.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // Validate file size (2MB max)
                        if (file.size > 2 * 1024 * 1024) {
                            showToast('File size must be less than 2MB', 'error');
                            this.value = '';
                            return;
                        }
                        
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const preview = document.getElementById('editProfilePicPreview');
                            preview.src = event.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            // ============================================
            // USER DASHBOARD FUNCTIONS
            // ============================================
            
            // Load User Dashboard
            function loadUserDashboard() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                // Update sidebar
                document.getElementById('sidebarUsername').textContent = currentUser.username;
                document.getElementById('sidebarCODMName').textContent = `CODM: ${currentUser.codmName}`;
                document.getElementById('sidebarMPRank').textContent = currentUser.mpRank;
                document.getElementById('sidebarBRRank').textContent = currentUser.brRank;
                document.getElementById('sidebarLevel').textContent = currentUser.level;
                document.getElementById('sidebarJoinDate').textContent = `Joined: ${formatDate(currentUser.joinDate)}`;
                
                // Set status badge
                const statusBadge = document.getElementById('sidebarStatus');
                statusBadge.textContent = currentUser.status;
                statusBadge.className = 'badge ';
                
                if (currentUser.status === 'Member' || currentUser.status === 'Admin') {
                    statusBadge.classList.add('badge-success');
                } else if (currentUser.status === 'Applicant') {
                    statusBadge.classList.add('badge-warning');
                } else if (currentUser.status === 'Pending') {
                    statusBadge.classList.add('badge-info');
                }
                
                // Set avatar if available
                if (currentUser.profilePic) {
                    document.getElementById('sidebarAvatar').src = currentUser.profilePic;
                }
                
                // Load dashboard data
                loadDashboardData();
                loadUserProfile();
                updateNotificationBadge();
                loadNotifications();
                
                // Show/hide apply button based on status
                const applyBtn = document.getElementById('applyToClanBtn');
                if (applyBtn) {
                    if (currentUser.status === 'Member' || currentUser.status === 'Admin') {
                        applyBtn.textContent = 'Already a Member';
                        applyBtn.disabled = true;
                        applyBtn.classList.remove('btn-primary');
                        applyBtn.classList.add('btn-secondary');
                    } else {
                        applyBtn.textContent = 'Apply to Clan';
                        applyBtn.disabled = false;
                        applyBtn.classList.remove('btn-secondary');
                        applyBtn.classList.add('btn-primary');
                    }
                }
                
                // Show/hide applications tab based on status
                const applicationsTab = document.querySelector('.tab[data-tab="applications"]');
                if (applicationsTab) {
                    if (currentUser.status === 'Member' || currentUser.status === 'Admin') {
                        applicationsTab.style.display = 'none';
                    } else {
                        applicationsTab.style.display = 'block';
                    }
                }
                
                // Show/hide events tab based on status (only for members)
                const eventsTab = document.getElementById('userEventsTab');
                const eventsTabLink = document.getElementById('eventsTabLink');
                if (eventsTab && eventsTabLink) {
                    if (currentUser.status === 'Member' || currentUser.status === 'Admin') {
                        eventsTab.classList.remove('hidden');
                        eventsTabLink.classList.remove('hidden');
                    } else {
                        eventsTab.classList.add('hidden');
                        eventsTabLink.classList.add('hidden');
                    }
                }
                
                // Check for new events
                checkNewEvents();
            }
            
            // Load Dashboard Data
            function loadDashboardData() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                document.getElementById('dashboardUsername').textContent = currentUser.username;
                
                // Load clan stats
                loadClanStats();
                
                // Load upcoming events
                loadUpcomingEvents();
                
                // Load top members
                loadTopMembers();
                
                // Load application status
                loadApplicationStatus();
            }
            
            // Load Clan Stats
            function loadClanStats() {
                const users = getUsers();
                const clanSettings = getClanSettings();
                
                // Calculate stats
                const members = users.filter(u => u.status === 'Member' || u.status === 'Admin');
                const totalMembers = members.length;
                
                // Calculate average MP rank
                const mpRankValues = members.map(m => getRankValue(m.mpRank));
                const avgMPRankValue = mpRankValues.length > 0 ? 
                    Math.round(mpRankValues.reduce((a, b) => a + b, 0) / mpRankValues.length) : 0;
                const avgMPRank = getRankFromValue(avgMPRankValue);
                
                // Calculate average BR rank
                const brRankValues = members.map(m => getRankValue(m.brRank));
                const avgBRRankValue = brRankValues.length > 0 ? 
                    Math.round(brRankValues.reduce((a, b) => a + b, 0) / brRankValues.length) : 0;
                const avgBRRank = getRankFromValue(avgBRRankValue);
                
                // Calculate clan age
                const clanAge = daysSince(clanSettings.creationDate);
                
                // Update UI
                document.getElementById('totalMembers').textContent = totalMembers;
                document.getElementById('avgMPRank').textContent = avgMPRank;
                document.getElementById('avgBRRank').textContent = avgBRRank;
                document.getElementById('clanAge').textContent = clanAge;
            }
            
            // Load Upcoming Events
            function loadUpcomingEvents() {
                const events = getEvents();
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const container = document.getElementById('upcomingEvents');
                if (!container) return;
                
                // Filter upcoming events (future events)
                const now = new Date();
                const upcomingEvents = events.filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate > now && event.status === 'upcoming';
                }).slice(0, 5); // Show only 5 upcoming events
                
                container.innerHTML = '';
                
                if (upcomingEvents.length === 0) {
                    container.innerHTML = '<div class="text-center" style="color: var(--text-secondary); padding: 20px;">No upcoming events</div>';
                    return;
                }
                
                upcomingEvents.forEach(event => {
                    const eventItem = document.createElement('div');
                    eventItem.className = 'activity-item';
                    eventItem.style.cursor = 'pointer';
                    eventItem.addEventListener('click', () => {
                        viewEvent(event.id);
                    });
                    
                    const eventDate = new Date(event.date);
                    const timeString = eventDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    eventItem.innerHTML = `
                        <div class="activity-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="activity-content">
                            <div><strong>${event.title}</strong></div>
                            <div>${event.type}  ${formatDate(event.date)} at ${timeString}</div>
                            <div class="activity-time">${event.priority === 'high' ? ' High Priority' : event.priority === 'urgent' ? ' URGENT' : ''}</div>
                        </div>
                    `;
                    
                    container.appendChild(eventItem);
                });
            }
            
            // Load Top Members
            function loadTopMembers() {
                const users = getUsers();
                const topMembersTable = document.getElementById('topMembersTable');
                
                if (!topMembersTable) return;
                
                // Get members (excluding applicants)
                const members = users.filter(u => u.status === 'Member' || u.status === 'Admin');
                
                // Sort by MP rank (highest first) and then by level
                members.sort((a, b) => {
                    const rankDiff = getRankValue(b.mpRank) - getRankValue(a.mpRank);
                    if (rankDiff !== 0) return rankDiff;
                    return b.level - a.level;
                });
                
                topMembersTable.innerHTML = '';
                
                // Show top 5 members
                members.slice(0, 5).forEach(member => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${member.username}</td>
                        <td>${member.mpRank}</td>
                        <td>${member.level}</td>
                    `;
                    
                    topMembersTable.appendChild(row);
                });
            }
            
            // Load Application Status
            function loadApplicationStatus() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const applications = getApplications();
                const userApplications = applications.filter(app => app.userId === currentUser.id);
                const container = document.getElementById('applicationStatusContainer');
                
                if (!container) return;
                
                if (userApplications.length === 0) {
                    container.innerHTML = `
                        <div class="text-center">
                            <p>You haven't submitted any clan applications yet.</p>
                            <button class="btn btn-primary mt-2" id="applyNowBtn">
                                <i class="fas fa-paper-plane"></i> Apply Now
                            </button>
                        </div>
                    `;
                    
                    document.getElementById('applyNowBtn')?.addEventListener('click', () => {
                        showModal('applicationModal');
                    });
                } else {
                    const latestApp = userApplications[userApplications.length - 1]; // Get most recent
                    
                    let statusBadge = '';
                    if (latestApp.status === 'Pending') {
                        statusBadge = '<span class="badge badge-warning">Pending Review</span>';
                    } else if (latestApp.status === 'Accepted') {
                        statusBadge = '<span class="badge badge-success">Accepted</span>';
                    } else if (latestApp.status === 'Rejected') {
                        statusBadge = '<span class="badge badge-danger">Rejected</span>';
                    }
                    
                    container.innerHTML = `
                        <div class="grid">
                            <div>
                                <p><strong>Application Date:</strong> ${formatDate(latestApp.date)}</p>
                                <p><strong>Status:</strong> ${statusBadge}</p>
                            </div>
                            <div>
                                <p><strong>Experience:</strong> ${latestApp.experience} years</p>
                                <p><strong>Playstyle:</strong> ${latestApp.playstyle}</p>
                            </div>
                        </div>
                        ${latestApp.status === 'Rejected' ? `
                            <div class="mt-3">
                                <button class="btn btn-primary" id="reapplyBtn">
                                    <i class="fas fa-redo"></i> Submit New Application
                                </button>
                            </div>
                        ` : ''}
                    `;
                    
                    if (latestApp.status === 'Rejected') {
                        document.getElementById('reapplyBtn')?.addEventListener('click', () => {
                            showModal('applicationModal');
                        });
                    }
                }
            }
            
            // Load User Profile
            function loadUserProfile() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                // Update profile page
                document.getElementById('profileUsername').textContent = currentUser.username;
                document.getElementById('profileCODMName').textContent = currentUser.codmName;
                document.getElementById('profileLevel').textContent = currentUser.level;
                document.getElementById('profileMPRank').textContent = currentUser.mpRank;
                document.getElementById('profileBRRank').textContent = currentUser.brRank;
                document.getElementById('profileGender').textContent = currentUser.gender;
                document.getElementById('profileDOB').textContent = formatDate(currentUser.dob);
                document.getElementById('profileJoinDate').textContent = formatDate(currentUser.joinDate);
                
                // Set status badge
                const statusBadge = document.getElementById('profileStatus');
                statusBadge.textContent = currentUser.status;
                statusBadge.className = 'badge ';
                
                if (currentUser.status === 'Member' || currentUser.status === 'Admin') {
                    statusBadge.classList.add('badge-success');
                } else if (currentUser.status === 'Applicant') {
                    statusBadge.classList.add('badge-warning');
                } else if (currentUser.status === 'Pending') {
                    statusBadge.classList.add('badge-info');
                }
                
                // Set profile picture
                const profilePic = document.getElementById('profilePicture');
                if (currentUser.profilePic) {
                    profilePic.src = currentUser.profilePic;
                } else {
                    profilePic.src = '';
                    profilePic.alt = 'No profile picture';
                }
            }
            
            // Load Clan Info
            function loadClanInfo() {
                const clanSettings = getClanSettings();
                const users = getUsers();
                
                // Update clan info
                document.getElementById('clanNameDisplay').textContent = clanSettings.clanName;
                document.getElementById('clanTagDisplay').textContent = clanSettings.clanTag;
                document.getElementById('clanDescription').textContent = clanSettings.clanDescription;
                
                // Update clan banner
                const banner = document.getElementById('clanBanner');
                if (banner) {
                    banner.style.background = `linear-gradient(to right, ${clanSettings.bannerColor}, #003300)`;
                }
                
                // Calculate clan statistics
                const members = users.filter(u => u.status === 'Member' || u.status === 'Admin');
                const applicants = users.filter(u => u.status === 'Applicant');
                const pending = users.filter(u => u.status === 'Pending');
                
                const totalMembers = members.length;
                const avgLevel = members.length > 0 ? 
                    Math.round(members.reduce((sum, member) => sum + member.level, 0) / members.length) : 0;
                const legendaryPlayers = members.filter(m => m.mpRank === 'Legendary' || m.brRank === 'Legendary').length;
                const activeApplicants = applicants.length + pending.length;
                
                // Update stats
                document.getElementById('clanTotalMembers').textContent = totalMembers;
                document.getElementById('clanAvgLevel').textContent = avgLevel;
                document.getElementById('clanLegendaryPlayers').textContent = legendaryPlayers;
                document.getElementById('clanActiveApplicants').textContent = activeApplicants;
                
                // Load clan members table
                loadClanMembersTable();
            }
            
            // Load Clan Members Table
            function loadClanMembersTable() {
                const users = getUsers();
                const table = document.getElementById('clanMembersTable');
                
                if (!table) return;
                
                // Get members (excluding applicants and pending)
                const members = users.filter(u => u.status === 'Member' || u.status === 'Admin');
                
                // Sort by join date (newest first)
                members.sort((a, b) => new Date(b.joinDate) - new Date(a.joinDate));
                
                table.innerHTML = '';
                
                members.forEach(member => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${member.username}</td>
                        <td>${member.codmName}</td>
                        <td>${member.level}</td>
                        <td>${member.mpRank}</td>
                        <td>
                            <span class="badge ${member.status === 'Admin' ? 'badge-success' : 'badge-info'}">
                                ${member.status}
                            </span>
                        </td>
                        <td>${formatDate(member.joinDate)}</td>
                    `;
                    
                    table.appendChild(row);
                });
            }
            
            // Load User Applications
            function loadUserApplications() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const applications = getApplications();
                const userApplications = applications.filter(app => app.userId === currentUser.id);
                const container = document.getElementById('myApplicationsContainer');
                
                if (!container) return;
                
                if (userApplications.length === 0) {
                    container.innerHTML = `
                        <div class="text-center">
                            <p>You haven't submitted any clan applications yet.</p>
                            <button class="btn btn-primary mt-2" id="createFirstApplicationBtn">
                                <i class="fas fa-plus"></i> Create Your First Application
                            </button>
                        </div>
                    `;
                    
                    document.getElementById('createFirstApplicationBtn')?.addEventListener('click', () => {
                        showModal('applicationModal');
                    });
                } else {
                    container.innerHTML = `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Experience</th>
                                        <th>Playstyle</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="userApplicationsTable">
                                    <!-- Applications will be dynamically added here -->
                                </tbody>
                            </table>
                        </div>
                    `;
                    
                    const table = document.getElementById('userApplicationsTable');
                    table.innerHTML = '';
                    
                    // Sort by date (newest first)
                    userApplications.sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    userApplications.forEach(app => {
                        let statusBadge = '';
                        if (app.status === 'Pending') {
                            statusBadge = '<span class="badge badge-warning">Pending</span>';
                        } else if (app.status === 'Accepted') {
                            statusBadge = '<span class="badge badge-success">Accepted</span>';
                        } else if (app.status === 'Rejected') {
                            statusBadge = '<span class="badge badge-danger">Rejected</span>';
                        }
                        
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${formatDate(app.date)}</td>
                            <td>${app.experience} year${app.experience > 1 ? 's' : ''}</td>
                            <td>${app.playstyle}</td>
                            <td>${statusBadge}</td>
                            <td>
                                <button class="btn btn-small btn-secondary view-application-btn" data-id="${app.id}">
                                    <i class="fas fa-eye"></i> View
                                </button>
                            </td>
                        `;
                        
                        table.appendChild(row);
                    });
                    
                    // Add event listeners to view buttons
                    document.querySelectorAll('.view-application-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const appId = parseInt(this.getAttribute('data-id'));
                            viewApplication(appId);
                        });
                    });
                }
            }
            
            // Load User Events
            function loadUserEvents() {
                const events = getEvents();
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const container = document.getElementById('eventsContainer');
                if (!container) return;
                
                // Filter upcoming events (future events)
                const now = new Date();
                const upcomingEvents = events.filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate > now && event.status === 'upcoming';
                });
                
                // Filter past events
                const pastEvents = events.filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate <= now || event.status === 'completed';
                });
                
                container.innerHTML = '';
                
                if (upcomingEvents.length === 0 && pastEvents.length === 0) {
                    container.innerHTML = '<div class="text-center" style="color: var(--text-secondary); padding: 20px;">No events scheduled</div>';
                    return;
                }
                
                if (upcomingEvents.length > 0) {
                    const upcomingSection = document.createElement('div');
                    upcomingSection.innerHTML = `<h4 class="mb-3"><i class="fas fa-calendar-check"></i> Upcoming Events</h4>`;
                    
                    const upcomingList = document.createElement('div');
                    upcomingList.className = 'grid';
                    
                    upcomingEvents.forEach(event => {
                        const eventCard = document.createElement('div');
                        eventCard.className = 'card';
                        eventCard.style.cursor = 'pointer';
                        eventCard.addEventListener('click', () => {
                            viewEvent(event.id);
                        });
                        
                        const eventDate = new Date(event.date);
                        const timeString = eventDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        
                        let priorityBadge = '';
                        if (event.priority === 'high') {
                            priorityBadge = '<span class="badge badge-warning">High Priority</span>';
                        } else if (event.priority === 'urgent') {
                            priorityBadge = '<span class="badge badge-danger">URGENT</span>';
                        }
                        
                        eventCard.innerHTML = `
                            <div class="card-header">
                                <h5 class="card-title">${event.title}</h5>
                                ${priorityBadge}
                            </div>
                            <div class="card-body">
                                <p><strong>Type:</strong> ${event.type}</p>
                                <p><strong>Date:</strong> ${formatDate(event.date)} at ${timeString}</p>
                                <p><strong>Description:</strong> ${event.description.substring(0, 100)}${event.description.length > 100 ? '...' : ''}</p>
                                <p><strong>Created by:</strong> ${event.createdBy}</p>
                            </div>
                        `;
                        
                        upcomingList.appendChild(eventCard);
                    });
                    
                    upcomingSection.appendChild(upcomingList);
                    container.appendChild(upcomingSection);
                }
                
                if (pastEvents.length > 0) {
                    const pastSection = document.createElement('div');
                    pastSection.innerHTML = `<h4 class="mb-3 mt-4"><i class="fas fa-history"></i> Past Events</h4>`;
                    
                    const pastList = document.createElement('div');
                    pastList.className = 'grid';
                    
                    pastEvents.slice(0, 3).forEach(event => { // Show only 3 past events
                        const eventCard = document.createElement('div');
                        eventCard.className = 'card';
                        eventCard.style.cursor = 'pointer';
                        eventCard.addEventListener('click', () => {
                            viewEvent(event.id);
                        });
                        
                        const eventDate = new Date(event.date);
                        const timeString = eventDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                        
                        eventCard.innerHTML = `
                            <div class="card-header">
                                <h5 class="card-title">${event.title}</h5>
                                <span class="badge badge-secondary">Completed</span>
                            </div>
                            <div class="card-body">
                                <p><strong>Type:</strong> ${event.type}</p>
                                <p><strong>Date:</strong> ${formatDate(event.date)} at ${timeString}</p>
                                <p><strong>Description:</strong> ${event.description.substring(0, 80)}${event.description.length > 80 ? '...' : ''}</p>
                            </div>
                        `;
                        
                        pastList.appendChild(eventCard);
                    });
                    
                    pastSection.appendChild(pastList);
                    container.appendChild(pastSection);
                }
            }
            
            // View Application Details
            function viewApplication(appId) {
                const applications = getApplications();
                const app = applications.find(a => a.id === appId);
                
                if (!app) return;
                
                const detailsContainer = document.getElementById('applicationDetails');
                const modalFooter = document.getElementById('applicationModalFooter');
                
                if (!detailsContainer || !modalFooter) return;
                
                let statusBadge = '';
                if (app.status === 'Pending') {
                    statusBadge = '<span class="badge badge-warning">Pending Review</span>';
                } else if (app.status === 'Accepted') {
                    statusBadge = '<span class="badge badge-success">Accepted</span>';
                } else if (app.status === 'Rejected') {
                    statusBadge = '<span class="badge badge-danger">Rejected</span>';
                }
                
                detailsContainer.innerHTML = `
                    <div class="grid">
                        <div>
                            <p><strong>Applicant:</strong> ${app.username}</p>
                            <p><strong>CODM Name:</strong> ${app.codmName}</p>
                            <p><strong>Level:</strong> ${app.level}</p>
                            <p><strong>Ranks:</strong> ${app.ranks}</p>
                        </div>
                        <div>
                            <p><strong>Status:</strong> ${statusBadge}</p>
                            <p><strong>Application Date:</strong> ${formatDate(app.date)}</p>
                            <p><strong>Experience:</strong> ${app.experience} year${app.experience > 1 ? 's' : ''}</p>
                            <p><strong>Playstyle:</strong> ${app.playstyle}</p>
                        </div>
                    </div>
                    <div class="mt-3">
                        <p><strong>Weekly Availability:</strong> ${app.availability} hours</p>
                        <p><strong>Microphone:</strong> ${app.microphone}</p>
                        <p><strong>Reason for joining:</strong></p>
                        <p>${app.reason}</p>
                    </div>
                `;
                
                // Clear modal footer
                modalFooter.innerHTML = '';
                
                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.className = 'btn btn-secondary';
                closeBtn.textContent = 'Close';
                closeBtn.addEventListener('click', () => {
                    hideModal('viewApplicationModal');
                });
                
                modalFooter.appendChild(closeBtn);
                
                // Show the modal
                showModal('viewApplicationModal');
            }
            
            // View Event Details
            function viewEvent(eventId) {
                const events = getEvents();
                const event = events.find(e => e.id === eventId);
                
                if (!event) return;
                
                const detailsContainer = document.getElementById('eventDetails');
                const modalFooter = document.getElementById('eventModalFooter');
                
                if (!detailsContainer || !modalFooter) return;
                
                const eventDate = new Date(event.date);
                const timeString = eventDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                let statusBadge = '';
                if (event.status === 'upcoming') {
                    statusBadge = '<span class="badge badge-success">Upcoming</span>';
                } else if (event.status === 'completed') {
                    statusBadge = '<span class="badge badge-secondary">Completed</span>';
                } else if (event.status === 'cancelled') {
                    statusBadge = '<span class="badge badge-danger">Cancelled</span>';
                }
                
                let priorityBadge = '';
                if (event.priority === 'high') {
                    priorityBadge = '<span class="badge badge-warning">High Priority</span>';
                } else if (event.priority === 'urgent') {
                    priorityBadge = '<span class="badge badge-danger">URGENT</span>';
                }
                
                detailsContainer.innerHTML = `
                    <div class="text-center mb-3">
                        <h3>${event.title}</h3>
                        <div class="mt-2">
                            ${statusBadge} ${priorityBadge}
                        </div>
                    </div>
                    
                    <div class="grid">
                        <div>
                            <p><strong>Type:</strong> ${event.type}</p>
                            <p><strong>Date:</strong> ${formatDate(event.date)}</p>
                            <p><strong>Time:</strong> ${timeString}</p>
                            <p><strong>Created by:</strong> ${event.createdBy}</p>
                        </div>
                        <div>
                            <p><strong>Max Players:</strong> ${event.maxPlayers}</p>
                            <p><strong>Participants:</strong> ${event.participants ? event.participants.length : 0}</p>
                            <p><strong>Created:</strong> ${formatDateTime(event.createdAt)}</p>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <h5>Description</h5>
                        <p>${event.description}</p>
                    </div>
                    
                    ${event.participants && event.participants.length > 0 ? `
                        <div class="mt-3">
                            <h5>Participants</h5>
                            <ul>
                                ${event.participants.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                `;
                
                // Clear modal footer
                modalFooter.innerHTML = '';
                
                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.className = 'btn btn-secondary';
                closeBtn.textContent = 'Close';
                closeBtn.addEventListener('click', () => {
                    hideModal('viewEventModal');
                });
                
                modalFooter.appendChild(closeBtn);
                
                // Show the modal
                showModal('viewEventModal');
            }
            
            // Submit Application
            function submitApplication(applicationData) {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const applications = getApplications();
                
                const newApplication = {
                    id: db.generateId(applications),
                    userId: currentUser.id,
                    username: currentUser.username,
                    codmName: currentUser.codmName,
                    level: currentUser.level,
                    ranks: `MP: ${currentUser.mpRank}, BR: ${currentUser.brRank}`,
                    experience: applicationData.experience,
                    playstyle: applicationData.playstyle,
                    availability: applicationData.availability,
                    microphone: applicationData.microphone,
                    reason: applicationData.reason,
                    status: "Pending",
                    date: new Date().toISOString().split('T')[0]
                };
                
                applications.push(newApplication);
                saveApplications(applications);
                
                // Update user status to Pending if currently Applicant
                if (currentUser.status === 'Applicant') {
                    const users = getUsers();
                    const userIndex = users.findIndex(u => u.id === currentUser.id);
                    
                    if (userIndex !== -1) {
                        users[userIndex].status = 'Pending';
                        saveUsers(users);
                        
                        // Update current user
                        currentUser.status = 'Pending';
                        saveCurrentUser(currentUser);
                    }
                }
                
                // Add activity log
                addActivityLog(currentUser.username, "Submitted a clan application");
                
                // Add notification for admin
                const users = getUsers();
                const admin = users.find(u => u.isAdmin);
                if (admin) {
                    addNotification(admin.id, `New clan application from ${currentUser.username}`);
                }
                
                // Show success message
                showToast('Application submitted successfully!', 'success');
                
                // Reload dashboard data
                loadDashboardData();
                loadUserApplications();
                
                // Hide modal
                hideModal('applicationModal');
            }
            
            // Update User Profile
            function updateUserProfile(profileData) {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const users = getUsers();
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                
                if (userIndex !== -1) {
                    // Update user data
                    users[userIndex].codmName = profileData.codmName;
                    users[userIndex].level = profileData.level;
                    users[userIndex].mpRank = profileData.mpRank;
                    users[userIndex].brRank = profileData.brRank;
                    users[userIndex].gender = profileData.gender;
                    users[userIndex].dob = profileData.dob;
                    
                    if (profileData.profilePic) {
                        users[userIndex].profilePic = profileData.profilePic;
                    }
                    
                    saveUsers(users);
                    
                    // Update current user
                    currentUser.codmName = profileData.codmName;
                    currentUser.level = profileData.level;
                    currentUser.mpRank = profileData.mpRank;
                    currentUser.brRank = profileData.brRank;
                    currentUser.gender = profileData.gender;
                    currentUser.dob = profileData.dob;
                    
                    if (profileData.profilePic) {
                        currentUser.profilePic = profileData.profilePic;
                    }
                    
                    saveCurrentUser(currentUser);
                    
                    // Add activity log
                    addActivityLog(currentUser.username, "Updated profile information");
                    
                    // Show success message
                    showToast('Profile updated successfully!', 'success');
                    
                    // Reload user dashboard
                    loadUserDashboard();
                    loadUserProfile();
                    
                    // Hide modal
                    hideModal('editProfileModal');
                    
                    return true;
                }
                
                return false;
            }
            
            // Change Password
            function changePassword(currentPassword, newPassword) {
                const currentUser = getCurrentUser();
                if (!currentUser) return false;
                
                // Verify current password
                if (currentUser.password !== currentPassword) {
                    showToast('Current password is incorrect', 'error');
                    return false;
                }
                
                // Validate new password
                const validationError = validatePassword(newPassword);
                if (validationError) {
                    showToast(validationError, 'error');
                    return false;
                }
                
                // Update password
                const users = getUsers();
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                
                if (userIndex !== -1) {
                    users[userIndex].password = newPassword;
                    saveUsers(users);
                    
                    // Update current user
                    currentUser.password = newPassword;
                    saveCurrentUser(currentUser);
                    
                    // Add activity log
                    addActivityLog(currentUser.username, "Changed password");
                    
                    showToast('Password changed successfully!', 'success');
                    return true;
                }
                
                return false;
            }
            
            // Delete Account
            function deleteAccount(password) {
                const currentUser = getCurrentUser();
                if (!currentUser) return false;
                
                // Verify password
                if (currentUser.password !== password) {
                    showToast('Incorrect password', 'error');
                    return false;
                }
                
                // Remove user from users
                const users = getUsers();
                const updatedUsers = users.filter(u => u.id !== currentUser.id);
                saveUsers(updatedUsers);
                
                // Remove user's applications
                const applications = getApplications();
                const updatedApplications = applications.filter(app => app.userId !== currentUser.id);
                saveApplications(updatedApplications);
                
                // Add activity log
                addActivityLog('System', `User ${currentUser.username} deleted their account`);
                
                // Clear current user and logout
                clearCurrentUser();
                logout();
                
                showToast('Account deleted successfully', 'success');
                return true;
            }
            
            // ============================================
            // ADMIN DASHBOARD FUNCTIONS
            // ============================================
            
            // Load Admin Dashboard
            function loadAdminDashboard() {
                const currentUser = getCurrentUser();
                if (!currentUser || !currentUser.isAdmin) return;
                
                // Update admin sidebar
                document.getElementById('adminSidebarUsername').textContent = currentUser.username;
                document.getElementById('adminSidebarJoinDate').textContent = `Joined: ${formatDate(currentUser.joinDate)}`;
                
                if (currentUser.profilePic) {
                    document.getElementById('adminSidebarAvatar').src = currentUser.profilePic;
                }
                
                // Load admin dashboard data
                loadAdminDashboardData();
                updateNotificationBadge();
                loadNotifications();
            }
            
            // Load Admin Dashboard Data
            function loadAdminDashboardData() {
                // Load admin stats
                loadAdminStats();
                
                // Load recent activity
                loadAdminRecentActivity();
                
                // Load member distribution
                loadMemberDistribution();
                
                // Load notifications
                loadAdminNotifications();
                
                // Load upcoming events count
                loadUpcomingEventsCount();
            }
            
            // Load Admin Stats
            function loadAdminStats() {
                const users = getUsers();
                const applications = getApplications();
                
                // Calculate new users in last 7 days
                const sevenDaysAgo = new Date();
                sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
                
                const newUsers = users.filter(u => {
                    const joinDate = new Date(u.joinDate);
                    return joinDate >= sevenDaysAgo;
                }).length;
                
                // Calculate pending applications
                const pendingApplications = applications.filter(app => app.status === 'Pending').length;
                
                // Calculate total members (excluding applicants)
                const totalMembers = users.filter(u => u.status === 'Member' || u.status === 'Admin').length;
                
                // Update UI
                document.getElementById('adminNewUsers').textContent = newUsers;
                document.getElementById('adminPendingApplications').textContent = pendingApplications;
                document.getElementById('adminTotalMembers').textContent = totalMembers;
                
                // Update quick stats in sidebar
                document.getElementById('adminPendingApps').textContent = pendingApplications;
                document.getElementById('adminTotalUsers').textContent = users.length;
                
                // Calculate active today (users who have applications or were active)
                const today = new Date().toISOString().split('T')[0];
                const activeToday = applications.filter(app => app.date === today).length;
                document.getElementById('adminActiveToday').textContent = activeToday;
            }
            
            // Load Upcoming Events Count
            function loadUpcomingEventsCount() {
                const events = getEvents();
                const now = new Date();
                
                const upcomingEvents = events.filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate > now && event.status === 'upcoming';
                }).length;
                
                document.getElementById('adminUpcomingEvents').textContent = upcomingEvents;
            }
            
            // Load Admin Recent Activity
            function loadAdminRecentActivity() {
                const logs = getActivityLogs();
                const activityContainer = document.getElementById('adminRecentActivity');
                
                if (!activityContainer) return;
                
                activityContainer.innerHTML = '';
                
                // Show only recent 5 activities
                logs.slice(0, 5).forEach(log => {
                    const activityItem = document.createElement('div');
                    activityItem.className = 'activity-item';
                    activityItem.innerHTML = `
                        <div class="activity-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="activity-content">
                            <div><strong>${log.user}</strong> ${log.action}</div>
                            <div class="activity-time">${formatDateTime(log.timestamp)}</div>
                        </div>
                    `;
                    
                    activityContainer.appendChild(activityItem);
                });
            }
            
            // Load Member Distribution
            function loadMemberDistribution() {
                const users = getUsers();
                
                const members = users.filter(u => u.status === 'Member').length;
                const applicants = users.filter(u => u.status === 'Applicant').length;
                const pending = users.filter(u => u.status === 'Pending').length;
                const admins = users.filter(u => u.status === 'Admin').length;
                
                document.getElementById('distMembers').textContent = members;
                document.getElementById('distApplicants').textContent = applicants;
                document.getElementById('distPending').textContent = pending;
                document.getElementById('distAdmins').textContent = admins;
            }
            
            // Load Admin Notifications
            function loadAdminNotifications() {
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const users = getUsers();
                const container = document.getElementById('adminNotificationsContainer');
                
                if (!container) return;
                
                // Get all notifications from all users (for demo, just show current admin's notifications)
                const admin = users.find(u => u.id === currentUser.id);
                
                if (!admin || !admin.notifications || admin.notifications.length === 0) {
                    container.innerHTML = '<p class="text-center" style="color: var(--text-secondary);">No notifications</p>';
                    return;
                }
                
                container.innerHTML = '';
                
                // Show only recent 5 notifications
                admin.notifications.slice(0, 5).forEach(notification => {
                    const notificationItem = document.createElement('div');
                    notificationItem.className = `activity-item ${notification.read ? '' : 'unread'}`;
                    notificationItem.innerHTML = `
                        <div class="activity-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="activity-content">
                            <div>${notification.message}</div>
                            <div class="activity-time">${formatDateTime(notification.timestamp)}</div>
                        </div>
                    `;
                    
                    container.appendChild(notificationItem);
                });
            }
            
            // Load Admin Applications
            function loadAdminApplications() {
                const applications = getApplications();
                const table = document.getElementById('adminApplicationsTable');
                
                if (!table) return;
                
                // Sort by date (newest first)
                applications.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                table.innerHTML = '';
                
                applications.forEach(app => {
                    let statusBadge = '';
                    if (app.status === 'Pending') {
                        statusBadge = '<span class="badge badge-warning">Pending</span>';
                    } else if (app.status === 'Accepted') {
                        statusBadge = '<span class="badge badge-success">Accepted</span>';
                    } else if (app.status === 'Rejected') {
                        statusBadge = '<span class="badge badge-danger">Rejected</span>';
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${app.username}</td>
                        <td>${app.codmName}</td>
                        <td>${app.level}</td>
                        <td>${app.ranks.split(',')[0].replace('MP: ', '')}</td>
                        <td>${app.experience} year${app.experience > 1 ? 's' : ''}</td>
                        <td>${statusBadge}</td>
                        <td>${formatDate(app.date)}</td>
                        <td>
                            <button class="btn btn-small btn-secondary view-admin-application-btn" data-id="${app.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            ${app.status === 'Pending' ? `
                                <button class="btn btn-small btn-success accept-application-btn" data-id="${app.id}">
                                    <i class="fas fa-check"></i> Accept
                                </button>
                                <button class="btn btn-small btn-danger reject-application-btn" data-id="${app.id}">
                                    <i class="fas fa-times"></i> Reject
                                </button>
                            ` : ''}
                        </td>
                    `;
                    
                    table.appendChild(row);
                });
                
                // Add event listeners
                document.querySelectorAll('.view-admin-application-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const appId = parseInt(this.getAttribute('data-id'));
                        viewAdminApplication(appId);
                    });
                });
                
                document.querySelectorAll('.accept-application-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const appId = parseInt(this.getAttribute('data-id'));
                        updateApplicationStatus(appId, 'Accepted');
                    });
                });
                
                document.querySelectorAll('.reject-application-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const appId = parseInt(this.getAttribute('data-id'));
                        updateApplicationStatus(appId, 'Rejected');
                    });
                });
            }
            
            // View Admin Application
            function viewAdminApplication(appId) {
                const applications = getApplications();
                const app = applications.find(a => a.id === appId);
                
                if (!app) return;
                
                const detailsContainer = document.getElementById('applicationDetails');
                const modalFooter = document.getElementById('applicationModalFooter');
                
                if (!detailsContainer || !modalFooter) return;
                
                let statusBadge = '';
                if (app.status === 'Pending') {
                    statusBadge = '<span class="badge badge-warning">Pending Review</span>';
                } else if (app.status === 'Accepted') {
                    statusBadge = '<span class="badge badge-success">Accepted</span>';
                } else if (app.status === 'Rejected') {
                    statusBadge = '<span class="badge badge-danger">Rejected</span>';
                }
                
                detailsContainer.innerHTML = `
                    <div class="grid">
                        <div>
                            <p><strong>Applicant:</strong> ${app.username}</p>
                            <p><strong>CODM Name:</strong> ${app.codmName}</p>
                            <p><strong>Level:</strong> ${app.level}</p>
                            <p><strong>Ranks:</strong> ${app.ranks}</p>
                        </div>
                        <div>
                            <p><strong>Status:</strong> ${statusBadge}</p>
                            <p><strong>Application Date:</strong> ${formatDate(app.date)}</p>
                            <p><strong>Experience:</strong> ${app.experience} year${app.experience > 1 ? 's' : ''}</p>
                            <p><strong>Playstyle:</strong> ${app.playstyle}</p>
                        </div>
                    </div>
                    <div class="mt-3">
                        <p><strong>Weekly Availability:</strong> ${app.availability} hours</p>
                        <p><strong>Microphone:</strong> ${app.microphone}</p>
                        <p><strong>Reason for joining:</strong></p>
                        <p>${app.reason}</p>
                    </div>
                `;
                
                // Clear modal footer
                modalFooter.innerHTML = '';
                
                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.className = 'btn btn-secondary';
                closeBtn.textContent = 'Close';
                closeBtn.addEventListener('click', () => {
                    hideModal('viewApplicationModal');
                });
                
                modalFooter.appendChild(closeBtn);
                
                // Add action buttons if application is pending
                if (app.status === 'Pending') {
                    const acceptBtn = document.createElement('button');
                    acceptBtn.className = 'btn btn-success';
                    acceptBtn.innerHTML = '<i class="fas fa-check"></i> Accept';
                    acceptBtn.addEventListener('click', () => {
                        updateApplicationStatus(appId, 'Accepted');
                        hideModal('viewApplicationModal');
                    });
                    
                    const rejectBtn = document.createElement('button');
                    rejectBtn.className = 'btn btn-danger';
                    rejectBtn.innerHTML = '<i class="fas fa-times"></i> Reject';
                    rejectBtn.addEventListener('click', () => {
                        updateApplicationStatus(appId, 'Rejected');
                        hideModal('viewApplicationModal');
                    });
                    
                    modalFooter.appendChild(acceptBtn);
                    modalFooter.appendChild(rejectBtn);
                }
                
                // Show the modal
                showModal('viewApplicationModal');
            }
            
            // Update Application Status
            function updateApplicationStatus(appId, status) {
                const applications = getApplications();
                const appIndex = applications.findIndex(a => a.id === appId);
                
                if (appIndex === -1) return;
                
                const app = applications[appIndex];
                const oldStatus = app.status;
                app.status = status;
                
                // Update user status if application is accepted
                if (status === 'Accepted') {
                    const users = getUsers();
                    const userIndex = users.findIndex(u => u.id === app.userId);
                    
                    if (userIndex !== -1) {
                        users[userIndex].status = 'Member';
                        saveUsers(users);
                        
                        // Update current user if they're the one being accepted
                        const currentUser = getCurrentUser();
                        if (currentUser && currentUser.id === app.userId) {
                            currentUser.status = 'Member';
                            saveCurrentUser(currentUser);
                        }
                        
                        // Add notification to user
                        addNotification(app.userId, `Your clan application has been accepted! Welcome to ${getClanSettings().clanName}!`);
                    }
                } else if (status === 'Rejected' && oldStatus === 'Pending') {
                    // If rejected, change user status back to Applicant
                    const users = getUsers();
                    const userIndex = users.findIndex(u => u.id === app.userId);
                    
                    if (userIndex !== -1) {
                        users[userIndex].status = 'Applicant';
                        saveUsers(users);
                        
                        // Update current user if they're the one being rejected
                        const currentUser = getCurrentUser();
                        if (currentUser && currentUser.id === app.userId) {
                            currentUser.status = 'Applicant';
                            saveCurrentUser(currentUser);
                        }
                        
                        // Add notification to user
                        addNotification(app.userId, `Your clan application has been rejected. You can submit a new application if you wish.`);
                    }
                }
                
                saveApplications(applications);
                
                // Add activity log
                const currentUser = getCurrentUser();
                if (currentUser) {
                    addActivityLog(currentUser.username, `${status.toLowerCase()} application from ${app.username}`);
                }
                
                // Show success message
                showToast(`Application ${status.toLowerCase()} successfully!`, 'success');
                
                // Reload admin applications
                loadAdminApplications();
                loadAdminDashboardData();
            }
            
            // Load Admin Users
            function loadAdminUsers() {
                const users = getUsers();
                const table = document.getElementById('adminUsersTable');
                
                if (!table) return;
                
                // Sort by join date (newest first)
                users.sort((a, b) => new Date(b.joinDate) - new Date(a.joinDate));
                
                table.innerHTML = '';
                
                users.forEach(user => {
                    let statusBadge = '';
                    if (user.status === 'Member') {
                        statusBadge = '<span class="badge badge-success">Member</span>';
                    } else if (user.status === 'Applicant') {
                        statusBadge = '<span class="badge badge-warning">Applicant</span>';
                    } else if (user.status === 'Pending') {
                        statusBadge = '<span class="badge badge-info">Pending</span>';
                    } else if (user.status === 'Admin') {
                        statusBadge = '<span class="badge badge-success">Admin</span>';
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${user.username}</td>
                        <td>${user.codmName}</td>
                        <td>${user.level}</td>
                        <td>${statusBadge}</td>
                        <td>${formatDate(user.joinDate)}</td>
                        <td>
                            <button class="btn btn-small btn-secondary view-user-btn" data-id="${user.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="btn btn-small btn-primary edit-user-btn" data-id="${user.id}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            ${!user.isAdmin ? `
                                <button class="btn btn-small btn-danger ban-user-btn" data-id="${user.id}">
                                    <i class="fas fa-ban"></i> Ban
                                </button>
                            ` : ''}
                        </td>
                    `;
                    
                    table.appendChild(row);
                });
                
                // Add event listeners
                document.querySelectorAll('.view-user-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const userId = parseInt(this.getAttribute('data-id'));
                        viewUserDetails(userId);
                    });
                });
                
                document.querySelectorAll('.edit-user-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const userId = parseInt(this.getAttribute('data-id'));
                        editUser(userId);
                    });
                });
                
                document.querySelectorAll('.ban-user-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const userId = parseInt(this.getAttribute('data-id'));
                        banUser(userId);
                    });
                });
            }
            
            // View User Details
            function viewUserDetails(userId) {
                const users = getUsers();
                const user = users.find(u => u.id === userId);
                
                if (!user) return;
                
                const detailsContainer = document.getElementById('adminUserDetails');
                const modalFooter = document.getElementById('adminUserModalFooter');
                
                if (!detailsContainer || !modalFooter) return;
                
                let statusBadge = '';
                if (user.status === 'Member') {
                    statusBadge = '<span class="badge badge-success">Member</span>';
                } else if (user.status === 'Applicant') {
                    statusBadge = '<span class="badge badge-warning">Applicant</span>';
                } else if (user.status === 'Pending') {
                    statusBadge = '<span class="badge badge-info">Pending</span>';
                } else if (user.status === 'Admin') {
                    statusBadge = '<span class="badge badge-success">Admin</span>';
                }
                
                detailsContainer.innerHTML = `
                    <div class="text-center mb-3">
                        ${user.profilePic ? `<img src="${user.profilePic}" alt="Profile" class="profile-pic-preview" style="width: 100px; height: 100px;">` : ''}
                        <h3>${user.username}</h3>
                        <p>${statusBadge}</p>
                    </div>
                    
                    <div class="grid">
                        <div>
                            <p><strong>CODM Name:</strong> ${user.codmName}</p>
                            <p><strong>Level:</strong> ${user.level}</p>
                            <p><strong>MP Rank:</strong> ${user.mpRank}</p>
                            <p><strong>BR Rank:</strong> ${user.brRank}</p>
                        </div>
                        <div>
                            <p><strong>Gender:</strong> ${user.gender}</p>
                            <p><strong>Date of Birth:</strong> ${formatDate(user.dob)}</p>
                            <p><strong>Join Date:</strong> ${formatDate(user.joinDate)}</p>
                            <p><strong>Is Admin:</strong> ${user.isAdmin ? 'Yes' : 'No'}</p>
                        </div>
                    </div>
                    
                    ${user.notifications && user.notifications.length > 0 ? `
                        <div class="mt-3">
                            <h4>Recent Notifications</h4>
                            <div style="max-height: 150px; overflow-y: auto;">
                                ${user.notifications.slice(0, 3).map(notif => `
                                    <div class="activity-item">
                                        <div>${notif.message}</div>
                                        <div class="activity-time">${formatDateTime(notif.timestamp)}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;
                
                // Clear modal footer
                modalFooter.innerHTML = '';
                
                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.className = 'btn btn-secondary';
                closeBtn.textContent = 'Close';
                closeBtn.addEventListener('click', () => {
                    hideModal('adminViewUserModal');
                });
                
                modalFooter.appendChild(closeBtn);
                
                // Add edit button
                const editBtn = document.createElement('button');
                editBtn.className = 'btn btn-primary';
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit User';
                editBtn.addEventListener('click', () => {
                    hideModal('adminViewUserModal');
                    editUser(userId);
                });
                
                modalFooter.appendChild(editBtn);
                
                // Show the modal
                showModal('adminViewUserModal');
            }
            
            // Edit User (Admin)
            function editUser(userId) {
                const users = getUsers();
                const user = users.find(u => u.id === userId);
                
                if (!user) return;
                
                // Populate edit form
                document.getElementById('adminEditUserId').value = userId;
                document.getElementById('adminEditUsername').value = user.username;
                document.getElementById('adminEditCODMName').value = user.codmName;
                document.getElementById('adminEditLevel').value = user.level;
                document.getElementById('adminEditMPRank').value = user.mpRank;
                document.getElementById('adminEditBRRank').value = user.brRank;
                document.getElementById('adminEditStatus').value = user.status;
                
                // Set admin radio button
                document.querySelectorAll('input[name="adminEditIsAdmin"]').forEach(radio => {
                    radio.checked = radio.value === user.isAdmin.toString();
                });
                
                showModal('adminEditUserModal');
            }
            
            // Save User Changes (Admin)
            function saveUserChanges() {
                const userId = parseInt(document.getElementById('adminEditUserId').value);
                const users = getUsers();
                const userIndex = users.findIndex(u => u.id === userId);
                
                if (userIndex === -1) return;
                
                const isAdmin = document.querySelector('input[name="adminEditIsAdmin"]:checked').value === 'true';
                
                // Update user data
                users[userIndex].username = document.getElementById('adminEditUsername').value;
                users[userIndex].codmName = document.getElementById('adminEditCODMName').value;
                users[userIndex].level = parseInt(document.getElementById('adminEditLevel').value);
                users[userIndex].mpRank = document.getElementById('adminEditMPRank').value;
                users[userIndex].brRank = document.getElementById('adminEditBRRank').value;
                users[userIndex].status = document.getElementById('adminEditStatus').value;
                users[userIndex].isAdmin = isAdmin;
                
                saveUsers(users);
                
                // Update current user if it's the same user
                const currentUser = getCurrentUser();
                if (currentUser && currentUser.id === userId) {
                    currentUser.username = users[userIndex].username;
                    currentUser.codmName = users[userIndex].codmName;
                    currentUser.level = users[userIndex].level;
                    currentUser.mpRank = users[userIndex].mpRank;
                    currentUser.brRank = users[userIndex].brRank;
                    currentUser.status = users[userIndex].status;
                    currentUser.isAdmin = users[userIndex].isAdmin;
                    saveCurrentUser(currentUser);
                }
                
                // Add activity log
                addActivityLog(currentUser.username, `Edited user ${users[userIndex].username}`);
                
                showToast('User updated successfully!', 'success');
                
                // Reload admin users
                loadAdminUsers();
                
                // Hide modal
                hideModal('adminEditUserModal');
            }
            
            // Ban User
            function banUser(userId) {
                const users = getUsers();
                const user = users.find(u => u.id === userId);
                
                if (!user) return;
                
                if (confirm(`Are you sure you want to ban ${user.username}? This action cannot be undone.`)) {
                    // Remove user (or mark as banned in a real app)
                    const updatedUsers = users.filter(u => u.id !== userId);
                    saveUsers(updatedUsers);
                    
                    // Remove user's applications
                    const applications = getApplications();
                    const updatedApplications = applications.filter(app => app.userId !== userId);
                    saveApplications(updatedApplications);
                    
                    // Add activity log
                    const currentUser = getCurrentUser();
                    if (currentUser) {
                        addActivityLog(currentUser.username, `Banned user ${user.username}`);
                    }
                    
                    showToast(`User ${user.username} has been banned`, 'success');
                    
                    // Reload admin users
                    loadAdminUsers();
                    loadAdminDashboardData();
                }
            }
            
            // Load Admin Events
            function loadAdminEvents() {
                const events = getEvents();
                const table = document.getElementById('adminEventsTable');
                
                if (!table) return;
                
                // Sort by date (newest first)
                events.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                
                table.innerHTML = '';
                
                events.forEach(event => {
                    let statusBadge = '';
                    if (event.status === 'upcoming') {
                        statusBadge = '<span class="badge badge-success">Upcoming</span>';
                    } else if (event.status === 'completed') {
                        statusBadge = '<span class="badge badge-secondary">Completed</span>';
                    } else if (event.status === 'cancelled') {
                        statusBadge = '<span class="badge badge-danger">Cancelled</span>';
                    }
                    
                    let priorityBadge = '';
                    if (event.priority === 'high') {
                        priorityBadge = '<span class="badge badge-warning">High</span>';
                    } else if (event.priority === 'urgent') {
                        priorityBadge = '<span class="badge badge-danger">Urgent</span>';
                    }
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${event.title}</td>
                        <td>${event.type}</td>
                        <td>${formatDateTime(event.date)}</td>
                        <td>${priorityBadge}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-small btn-secondary view-event-btn" data-id="${event.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="btn btn-small btn-danger delete-event-btn" data-id="${event.id}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    
                    table.appendChild(row);
                });
                
                // Add event listeners
                document.querySelectorAll('.view-event-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const eventId = parseInt(this.getAttribute('data-id'));
                        viewEvent(eventId);
                    });
                });
                
                document.querySelectorAll('.delete-event-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const eventId = parseInt(this.getAttribute('data-id'));
                        deleteEvent(eventId);
                    });
                });
            }
            
            // Create Event
            function createEvent(eventData) {
                const events = getEvents();
                const currentUser = getCurrentUser();
                if (!currentUser) return;
                
                const newEvent = {
                    id: db.generateId(events),
                    title: eventData.title,
                    type: eventData.type,
                    description: eventData.description,
                    date: eventData.date,
                    createdBy: currentUser.username,
                    createdAt: new Date().toISOString(),
                    maxPlayers: eventData.maxPlayers,
                    priority: eventData.priority,
                    status: 'upcoming',
                    participants: []
                };
                
                events.push(newEvent);
                saveEvents(events);
                
                // Add activity log
                addActivityLog(currentUser.username, `Created new event: ${eventData.title}`);
                
                // Send notifications to all members if selected
                if (eventData.sendNotification) {
                    const users = getUsers();
                    const members = users.filter(u => u.status === 'Member' || u.status === 'Admin');
                    
                    members.forEach(member => {
                        if (member.id !== currentUser.id) {
                            addNotification(member.id, `New clan event: ${eventData.title} on ${formatDate(eventData.date)}`);
                        }
                    });
                    
                    // Show announcement for current users
                    showEventAnnouncement(eventData.title, eventData.description);
                }
                
                showToast('Event created successfully!', 'success');
                
                // Clear form
                document.getElementById('createEventForm').reset();
                
                // Reload events
                loadAdminEvents();
                loadAdminDashboardData();
                
                return newEvent.id;
            }
            
            // Delete Event
            function deleteEvent(eventId) {
                if (!confirm('Are you sure you want to delete this event?')) return;
                
                const events = getEvents();
                const eventIndex = events.findIndex(e => e.id === eventId);
                
                if (eventIndex === -1) return;
                
                const event = events[eventIndex];
                events.splice(eventIndex, 1);
                saveEvents(events);
                
                // Add activity log
                const currentUser = getCurrentUser();
                if (currentUser) {
                    addActivityLog(currentUser.username, `Deleted event: ${event.title}`);
                }
                
                showToast('Event deleted successfully!', 'success');
                
                // Reload events
                loadAdminEvents();
                loadAdminDashboardData();
            }
            
            // Load Admin Activity Logs
            function loadAdminActivityLogs() {
                const logs = getActivityLogs();
                const container = document.getElementById('adminActivityLogs');
                
                if (!container) return;
                
                container.innerHTML = '';
                
                logs.forEach(log => {
                    const activityItem = document.createElement('div');
                    activityItem.className = 'activity-item';
                    activityItem.innerHTML = `
                        <div class="activity-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="activity-content">
                            <div><strong>${log.user}</strong> ${log.action}</div>
                            <div class="activity-time">${formatDateTime(log.timestamp)}</div>
                        </div>
                    `;
                    
                    container.appendChild(activityItem);
                });
            }
            
            // Load Admin Settings
            function loadAdminSettings() {
                const clanSettings = getClanSettings();
                const websiteSettings = getWebsiteSettings();
                
                // Load clan settings
                document.getElementById('clanNameInput').value = clanSettings.clanName;
                document.getElementById('clanTagInput').value = clanSettings.clanTag;
                document.getElementById('clanDescriptionInput').value = clanSettings.clanDescription;
                document.getElementById('clanBannerColor').value = clanSettings.bannerColor;
                document.getElementById('clanCreationDate').value = clanSettings.creationDate;
                document.getElementById('registrationStatus').value = clanSettings.registrationStatus;
                
                // Load website settings
                document.getElementById('websiteNameInput').value = websiteSettings.websiteName;
                document.getElementById('websiteTheme').value = websiteSettings.theme;
                document.getElementById('whatsappNumber').value = websiteSettings.whatsappNumber;
                document.getElementById('autoApproveLevel').value = websiteSettings.autoApproveLevel;
            }
            
            // Save Clan Settings
            function saveClanSettingsData(settings) {
                saveClanSettingsData(settings);
                
                // Update UI
                document.getElementById('clanName').textContent = settings.clanName;
                document.getElementById('websiteName').textContent = settings.clanName;
                document.getElementById('clanNameDisplay').textContent = settings.clanName;
                document.getElementById('clanTagDisplay').textContent = settings.clanTag;
                document.getElementById('clanDescription').textContent = settings.clanDescription;
                
                // Update banner
                const banner = document.getElementById('clanBanner');
                if (banner) {
                    banner.style.background = `linear-gradient(to right, ${settings.bannerColor}, #003300)`;
                }
                
                // Add activity log
                const currentUser = getCurrentUser();
                if (currentUser) {
                    addActivityLog(currentUser.username, "Updated clan settings");
                }
                
                showToast('Clan settings saved successfully!', 'success');
            }
            
            // Save Website Settings
            function saveWebsiteSettingsData(settings) {
                saveWebsiteSettings(settings);
                
                // Update UI
                document.getElementById('websiteName').textContent = settings.websiteName;
                document.getElementById('clanName').textContent = settings.websiteName;
                
                // Apply theme
                applyTheme(settings.theme);
                
                // Add activity log
                const currentUser = getCurrentUser();
                if (currentUser) {
                    addActivityLog(currentUser.username, "Updated website settings");
                }
                
                showToast('Website settings saved successfully!', 'success');
            }
            
            // Apply Theme
            function applyTheme(theme) {
                const root = document.documentElement;
                
                switch (theme) {
                    case 'dark':
                        root.style.setProperty('--primary-color', '#ffffff');
                        root.style.setProperty('--primary-dark', '#cccccc');
                        break;
                    case 'blue':
                        root.style.setProperty('--primary-color', '#0088ff');
                        root.style.setProperty('--primary-dark', '#0066cc');
                        break;
                    case 'red':
                        root.style.setProperty('--primary-color', '#ff3333');
                        root.style.setProperty('--primary-dark', '#cc0000');
                        break;
                    case 'cyberpunk':
                    default:
                        root.style.setProperty('--primary-color', '#00ff00');
                        root.style.setProperty('--primary-dark', '#00cc00');
                        break;
                }
            }
            
            // Export Logs
            function exportLogs() {
                const logs = getActivityLogs();
                const logText = logs.map(log => `${log.timestamp} - ${log.user}: ${log.action}`).join('\n');
                
                const blob = new Blob([logText], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'voidm-activity-logs.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('Activity logs exported successfully!', 'success');
            }
            
            // Clear Logs
            function clearLogs() {
                if (confirm('Are you sure you want to clear all activity logs? This action cannot be undone.')) {
                    saveActivityLogs([]);
                    loadAdminActivityLogs();
                    showToast('Activity logs cleared successfully!', 'success');
                }
            }
            
            // Add New User (Admin)
            function addNewUser(userData) {
                const users = getUsers();
                
                // Check if username already exists
                if (users.some(u => u.username === userData.username)) {
                    showToast('Username already exists', 'error');
                    return false;
                }
                
                const newUser = {
                    id: db.generateId(users),
                    username: userData.username,
                    password: userData.password,
                    codmName: userData.codmName,
                    level: userData.level,
                    mpRank: 'Rookie',
                    brRank: 'Rookie',
                    gender: 'Male',
                    dob: '2000-01-01',
                    status: userData.status,
                    isAdmin: userData.status === 'Admin',
                    joinDate: new Date().toISOString().split('T')[0],
                    profilePic: '',
                    notifications: []
                };
                
                users.push(newUser);
                saveUsers(users);
                
                // Add activity log
                const currentUser = getCurrentUser();
                if (currentUser) {
                    addActivityLog(currentUser.username, `Added new user: ${userData.username}`);
                }
                
                // Add notification to the new user
                if (userData.status === 'Admin') {
                    addNotification(newUser.id, `You have been added as an administrator by ${currentUser.username}`);
                } else {
                    addNotification(newUser.id, `Welcome to ${getClanSettings().clanName}! Your account has been created by an administrator.`);
                }
                
                showToast(`User ${userData.username} added successfully!`, 'success');
                return true;
            }
            
            // ============================================
            // AUTHENTICATION FUNCTIONS
            // ============================================
            
            // Login
            function login(username, password, rememberMe) {
                const users = getUsers();
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    // Save current user
                    saveCurrentUser(user);
                    
                    // Add activity log
                    addActivityLog(username, "Logged in");
                    
                    // Redirect based on user type
                    if (user.isAdmin) {
                        showPage('adminPage');
                    } else {
                        showPage('dashboardPage');
                    }
                    
                    // Show event announcement if any
                    checkNewEvents();
                    
                    showToast(`Welcome back, ${username}!`, 'success');
                    return true;
                } else {
                    showToast('Invalid username or password', 'error');
                    return false;
                }
            }
            
            // Register
            function register(userData) {
                const users = getUsers();
                
                // Validate username
                const usernameError = validateUsername(userData.username);
                if (usernameError) {
                    showToast(usernameError, 'error');
                    return false;
                }
                
                // Validate password
                const passwordError = validatePassword(userData.password);
                if (passwordError) {
                    showToast(passwordError, 'error');
                    return false;
                }
                
                // Check if passwords match
                if (userData.password !== userData.confirmPassword) {
                    showToast('Passwords do not match', 'error');
                    return false;
                }
                
                // Validate level (max 400)
                if (userData.level < 1 || userData.level > 400) {
                    showToast('Level must be between 1 and 400', 'error');
                    return false;
                }
                
                // Validate date of birth (must be at least 13 years old)
                const dob = new Date(userData.dob);
                const today = new Date();
                const age = today.getFullYear() - dob.getFullYear();
                if (age < 13) {
                    showToast('You must be at least 13 years old to register', 'error');
                    return false;
                }
                
                const newUser = {
                    id: db.generateId(users),
                    username: userData.username,
                    password: userData.password,
                    codmName: userData.codmName,
                    level: userData.level,
                    mpRank: userData.mpRank,
                    brRank: userData.brRank,
                    gender: userData.gender,
                    dob: userData.dob,
                    status: 'Applicant',
                    isAdmin: false,
                    joinDate: new Date().toISOString().split('T')[0],
                    profilePic: userData.profilePic || '',
                    notifications: [
                        {
                            id: 1,
                            message: `Welcome to ${getClanSettings().clanName}! Please submit a clan application to become a member.`,
                            timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19),
                            read: false
                        }
                    ]
                };
                
                users.push(newUser);
                saveUsers(users);
                
                // Save as current user and login
                saveCurrentUser(newUser);
                
                // Add activity log
                addActivityLog(userData.username, "Registered new account");
                
                // Add notification for admin
                const admin = users.find(u => u.isAdmin);
                if (admin) {
                    addNotification(admin.id, `New user registered: ${userData.username}`);
                }
                
                showToast('Account created successfully!', 'success');
                
                // Redirect to dashboard
                showPage('dashboardPage');
                return true;
            }
            
            // Recover Password
            function recoverPassword(username, dob) {
                const users = getUsers();
                const user = users.find(u => u.username === username && u.dob === dob);
                
                if (user) {
                    // In a real app, you would send an email or generate a reset token
                    // For this demo, we'll just show the password (INSECURE - for demo only)
                    alert(`Your password is: ${user.password}\n\nPlease change it immediately after logging in.`);
                    
                    // Add activity log
                    addActivityLog('System', `Password recovery for ${username}`);
                    
                    showToast('Password recovered successfully. Please check the alert.', 'success');
                    return true;
                } else {
                    showToast('No account found with that username and date of birth', 'error');
                    return false;
                }
            }
            
            // Logout
            function logout() {
                const currentUser = getCurrentUser();
                if (currentUser) {
                    addActivityLog(currentUser.username, "Logged out");
                }
                
                clearCurrentUser();
                showPage('loginPage');
                showToast('Logged out successfully', 'success');
            }
            
            // Check Auto Login - MODIFIED TO ALWAYS START WITH LOGIN PAGE
            function checkAutoLogin() {
                const currentUser = getCurrentUser();
                
                // ALWAYS show login page first for security
                showPage('loginPage');
                
                // Optional: You can enable auto-login by uncommenting this:
                /*
                if (currentUser) {
                    if (currentUser.isAdmin) {
                        showPage('adminPage');
                    } else {
                        showPage('dashboardPage');
                    }
                } else {
                    showPage('loginPage');
                }
                */
            }
            
            // ============================================
            // EVENT LISTENERS
            // ============================================
            
            // Initialize when DOM is loaded
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize UI components
                initModals();
                initTabs();
                initPasswordToggles();
                initProfilePicturePreview();
                
                // Check auto login
                checkAutoLogin();
                
                // ========== LOGIN PAGE ==========
                
                // Login form submission
                document.getElementById('loginForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const username = document.getElementById('loginUsername').value;
                    const password = document.getElementById('loginPassword').value;
                    const rememberMe = document.getElementById('rememberMe').checked;
                    
                    login(username, password, rememberMe);
                });
                
                // Go to registration page
                document.getElementById('goToRegister')?.addEventListener('click', function() {
                    showPage('registerPage');
                });
                
                document.getElementById('registerLink')?.addEventListener('click', function(e) {
                    e.preventDefault();
                    showPage('registerPage');
                });
                
                // Forgot password
                document.getElementById('forgotPasswordLink')?.addEventListener('click', function(e) {
                    e.preventDefault();
                    showModal('forgotPasswordModal');
                });
                
                // ========== REGISTRATION PAGE ==========
                
                // Registration form submission
                document.getElementById('registerForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const gender = document.querySelector('input[name="gender"]:checked')?.value || 'Male';
                    
                    // Get profile picture data
                    const profilePicInput = document.getElementById('regProfilePic');
                    let profilePic = '';
                    
                    // Validate level
                    const level = parseInt(document.getElementById('regLevel').value);
                    if (level < 1 || level > 400) {
                        showToast('Level must be between 1 and 400', 'error');
                        return;
                    }
                    
                    // Validate date of birth
                    const dob = document.getElementById('regDOB').value;
                    const dobDate = new Date(dob);
                    const today = new Date();
                    const age = today.getFullYear() - dobDate.getFullYear();
                    if (age < 13) {
                        showToast('You must be at least 13 years old to register', 'error');
                        return;
                    }
                    
                    if (profilePicInput.files && profilePicInput.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const userData = {
                                username: document.getElementById('regUsername').value,
                                password: document.getElementById('regPassword').value,
                                confirmPassword: document.getElementById('regConfirmPassword').value,
                                codmName: document.getElementById('regCODMName').value,
                                level: level,
                                mpRank: document.getElementById('regMPRank').value,
                                brRank: document.getElementById('regBRRank').value,
                                gender: gender,
                                dob: dob,
                                profilePic: event.target.result
                            };
                            
                            register(userData);
                        };
                        reader.readAsDataURL(profilePicInput.files[0]);
                    } else {
                        const userData = {
                            username: document.getElementById('regUsername').value,
                            password: document.getElementById('regPassword').value,
                            confirmPassword: document.getElementById('regConfirmPassword').value,
                            codmName: document.getElementById('regCODMName').value,
                            level: level,
                            mpRank: document.getElementById('regMPRank').value,
                            brRank: document.getElementById('regBRRank').value,
                            gender: gender,
                            dob: dob,
                            profilePic: ''
                        };
                        
                        register(userData);
                    }
                });
                
                // Go back to login
                document.getElementById('goToLogin')?.addEventListener('click', function() {
                    showPage('loginPage');
                });
                
                // ========== FORGOT PASSWORD MODAL ==========
                
                // Recover password
                document.getElementById('recoverPasswordBtn')?.addEventListener('click', function() {
                    const username = document.getElementById('recoveryUsername').value;
                    const dob = document.getElementById('recoveryDOB').value;
                    
                    if (username && dob) {
                        recoverPassword(username, dob);
                        hideModal('forgotPasswordModal');
                    } else {
                        showToast('Please fill in all fields', 'error');
                    }
                });
                
                // ========== EVENT ANNOUNCEMENT ==========
                
                // Close event announcement
                document.getElementById('closeEventAnnouncement')?.addEventListener('click', function() {
                    document.getElementById('eventAnnouncement').style.display = 'none';
                });
                
                // ========== USER DASHBOARD ==========
                
                // Logout button
                document.getElementById('logoutBtn')?.addEventListener('click', function() {
                    logout();
                });
                
                // Apply to clan button
                document.getElementById('applyToClanBtn')?.addEventListener('click', function() {
                    showModal('applicationModal');
                });
                
                // New application button
                document.getElementById('newApplicationBtn')?.addEventListener('click', function() {
                    showModal('applicationModal');
                });
                
                // Application form submission
                document.getElementById('submitApplicationBtn')?.addEventListener('click', function() {
                    const experience = document.getElementById('appExperience').value;
                    const playstyle = document.getElementById('appPlaystyle').value;
                    const availability = document.getElementById('appAvailability').value;
                    const microphone = document.querySelector('input[name="microphone"]:checked')?.value || 'No';
                    const reason = document.getElementById('appReason').value;
                    
                    if (!experience || !playstyle || !availability || !reason) {
                        showToast('Please fill in all fields', 'error');
                        return;
                    }
                    
                    const applicationData = {
                        experience: parseInt(experience),
                        playstyle: playstyle,
                        availability: parseInt(availability),
                        microphone: microphone,
                        reason: reason
                    };
                    
                    submitApplication(applicationData);
                });
                
                // Edit profile button
                document.getElementById('editProfileBtn')?.addEventListener('click', function() {
                    const currentUser = getCurrentUser();
                    if (!currentUser) return;
                    
                    // Populate edit form with current data
                    document.getElementById('editUsername').value = currentUser.username;
                    document.getElementById('editCODMName').value = currentUser.codmName;
                    document.getElementById('editLevel').value = currentUser.level;
                    document.getElementById('editMPRank').value = currentUser.mpRank;
                    document.getElementById('editBRRank').value = currentUser.brRank;
                    
                    // Set gender radio button
                    document.querySelectorAll('input[name="editGender"]').forEach(radio => {
                        radio.checked = radio.value === currentUser.gender;
                    });
                    
                    document.getElementById('editDOB').value = currentUser.dob;
                    
                    // Set profile picture preview
                    const preview = document.getElementById('editProfilePicPreview');
                    if (currentUser.profilePic) {
                        preview.src = currentUser.profilePic;
                    } else {
                        preview.src = '';
                    }
                    
                    showModal('editProfileModal');
                });
                
                // Save profile changes
                document.getElementById('saveProfileBtn')?.addEventListener('click', function() {
                    const gender = document.querySelector('input[name="editGender"]:checked')?.value || 'Male';
                    
                    // Validate level
                    const level = parseInt(document.getElementById('editLevel').value);
                    if (level < 1 || level > 400) {
                        showToast('Level must be between 1 and 400', 'error');
                        return;
                    }
                    
                    // Get profile picture data
                    const profilePicInput = document.getElementById('editProfilePic');
                    let profilePic = null;
                    
                    if (profilePicInput.files && profilePicInput.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const profileData = {
                                codmName: document.getElementById('editCODMName').value,
                                level: level,
                                mpRank: document.getElementById('editMPRank').value,
                                brRank: document.getElementById('editBRRank').value,
                                gender: gender,
                                dob: document.getElementById('editDOB').value,
                                profilePic: event.target.result
                            };
                            
                            updateUserProfile(profileData);
                        };
                        reader.readAsDataURL(profilePicInput.files[0]);
                    } else {
                        const profileData = {
                            codmName: document.getElementById('editCODMName').value,
                            level: level,
                            mpRank: document.getElementById('editMPRank').value,
                            brRank: document.getElementById('editBRRank').value,
                            gender: gender,
                            dob: document.getElementById('editDOB').value,
                            profilePic: null
                        };
                        
                        updateUserProfile(profileData);
                    }
                });
                
                // Change password form
                document.getElementById('changePasswordForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const currentPassword = document.getElementById('currentPassword').value;
                    const newPassword = document.getElementById('newPassword').value;
                    const confirmNewPassword = document.getElementById('confirmNewPassword').value;
                    
                    if (newPassword !== confirmNewPassword) {
                        showToast('New passwords do not match', 'error');
                        return;
                    }
                    
                    if (changePassword(currentPassword, newPassword)) {
                        document.getElementById('changePasswordForm').reset();
                    }
                });
                
                // Delete account button
                document.getElementById('deleteAccountBtn')?.addEventListener('click', function() {
                    showModal('deleteAccountModal');
                });
                
                // Confirm delete account
                document.getElementById('confirmDeleteAccountBtn')?.addEventListener('click', function() {
                    const password = document.getElementById('confirmDeletePassword').value;
                    
                    if (!password) {
                        showToast('Please enter your password', 'error');
                        return;
                    }
                    
                    if (deleteAccount(password)) {
                        hideModal('deleteAccountModal');
                    }
                });
                
                // Theme color picker
                document.getElementById('themeColorPicker')?.addEventListener('input', function() {
                    document.documentElement.style.setProperty('--primary-color', this.value);
                    
                    // Calculate a darker shade for primary-dark
                    const hex = this.value.substring(1);
                    const r = parseInt(hex.substring(0, 2), 16);
                    const g = parseInt(hex.substring(2, 4), 16);
                    const b = parseInt(hex.substring(4, 6), 16);
                    
                    const darkerR = Math.max(0, r - 50);
                    const darkerG = Math.max(0, g - 50);
                    const darkerB = Math.max(0, b - 50);
                    
                    const darkerHex = `#${darkerR.toString(16).padStart(2, '0')}${darkerG.toString(16).padStart(2, '0')}${darkerB.toString(16).padStart(2, '0')}`;
                    document.documentElement.style.setProperty('--primary-dark', darkerHex);
                });
                
                // Reset theme button
                document.getElementById('resetThemeBtn')?.addEventListener('click', function() {
                    document.documentElement.style.setProperty('--primary-color', '#00ff00');
                    document.documentElement.style.setProperty('--primary-dark', '#00cc00');
                    document.getElementById('themeColorPicker').value = '#00ff00';
                });
                
                // ========== ADMIN DASHBOARD ==========
                
                // Create event button
                document.getElementById('createEventBtn')?.addEventListener('click', function() {
                    // Switch to admin events tab
                    document.querySelector('.tab[data-tab="adminEvents"]').click();
                });
                
                // View all users button
                document.getElementById('viewAllUsersBtn')?.addEventListener('click', function() {
                    // Switch to admin users tab
                    document.querySelector('.tab[data-tab="adminUsers"]').click();
                });
                
                // View activity logs button
                document.getElementById('viewActivityLogsBtn')?.addEventListener('click', function() {
                    // Switch to admin activity tab
                    document.querySelector('.tab[data-tab="adminActivity"]').click();
                });
                
                // Manage events button
                document.getElementById('manageEventsBtn')?.addEventListener('click', function() {
                    // Switch to admin events tab
                    document.querySelector('.tab[data-tab="adminEvents"]').click();
                });
                
                // Filter applications buttons
                document.getElementById('filterPendingBtn')?.addEventListener('click', function() {
                    // In a full implementation, this would filter the applications table
                    showToast('Showing pending applications only', 'info');
                });
                
                document.getElementById('filterAllBtn')?.addEventListener('click', function() {
                    // In a full implementation, this would show all applications
                    showToast('Showing all applications', 'info');
                });
                
                // Add new user button
                document.getElementById('addNewUserBtn')?.addEventListener('click', function() {
                    showModal('adminAddUserModal');
                });
                
                // Admin add user button
                document.getElementById('adminAddUserBtn')?.addEventListener('click', function() {
                    const username = document.getElementById('adminAddUsername').value;
                    const password = document.getElementById('adminAddPassword').value;
                    const codmName = document.getElementById('adminAddCODMName').value;
                    const level = parseInt(document.getElementById('adminAddLevel').value);
                    const status = document.getElementById('adminAddStatus').value;
                    
                    if (!username || !password || !codmName) {
                        showToast('Please fill in all required fields', 'error');
                        return;
                    }
                    
                    if (level < 1 || level > 400) {
                        showToast('Level must be between 1 and 400', 'error');
                        return;
                    }
                    
                    const userData = {
                        username: username,
                        password: password,
                        codmName: codmName,
                        level: level,
                        status: status
                    };
                    
                    if (addNewUser(userData)) {
                        hideModal('adminAddUserModal');
                        document.getElementById('adminAddUserForm').reset();
                    }
                });
                
                // Admin save user button
                document.getElementById('adminSaveUserBtn')?.addEventListener('click', function() {
                    saveUserChanges();
                });
                
                // Create event form
                document.getElementById('createEventForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const title = document.getElementById('eventTitle').value;
                    const date = document.getElementById('eventDate').value;
                    const type = document.getElementById('eventType').value;
                    const description = document.getElementById('eventDescription').value;
                    const maxPlayers = parseInt(document.getElementById('eventMaxPlayers').value);
                    const priority = document.getElementById('eventPriority').value;
                    const sendNotification = document.getElementById('sendNotification').checked;
                    
                    if (!title || !date || !description) {
                        showToast('Please fill in all required fields', 'error');
                        return;
                    }
                    
                    const eventData = {
                        title: title,
                        date: date,
                        type: type,
                        description: description,
                        maxPlayers: maxPlayers,
                        priority: priority,
                        sendNotification: sendNotification
                    };
                    
                    createEvent(eventData);
                });
                
                // Export logs button
                document.getElementById('exportLogsBtn')?.addEventListener('click', function() {
                    exportLogs();
                });
                
                // Clear logs button
                document.getElementById('clearLogsBtn')?.addEventListener('click', function() {
                    clearLogs();
                });
                
                // Clan settings form
                document.getElementById('clanSettingsForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const settings = {
                        id: 1,
                        clanName: document.getElementById('clanNameInput').value,
                        clanTag: document.getElementById('clanTagInput').value,
                        clanDescription: document.getElementById('clanDescriptionInput').value,
                        clanLogo: '', // Would handle file upload in real app
                        bannerColor: document.getElementById('clanBannerColor').value,
                        creationDate: document.getElementById('clanCreationDate').value,
                        registrationStatus: document.getElementById('registrationStatus').value
                    };
                    
                    saveClanSettingsData(settings);
                });
                
                // Website settings form
                document.getElementById('websiteSettingsForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const settings = {
                        id: 1,
                        websiteName: document.getElementById('websiteNameInput').value,
                        theme: document.getElementById('websiteTheme').value,
                        whatsappNumber: document.getElementById('whatsappNumber').value,
                        autoApproveLevel: parseInt(document.getElementById('autoApproveLevel').value)
                    };
                    
                    saveWebsiteSettingsData(settings);
                });
                
                // ========== NOTIFICATIONS ==========
                
                // Notification bell click
                document.getElementById('notificationBell')?.addEventListener('click', function() {
                    const dropdown = document.getElementById('notificationDropdown');
                    dropdown.classList.toggle('show');
                    
                    // Mark notifications as read when opening dropdown
                    const currentUser = getCurrentUser();
                    if (currentUser && dropdown.classList.contains('show')) {
                        markNotificationsAsRead(currentUser.id);
                    }
                });
                
                // Mark all notifications as read
                document.getElementById('markAllRead')?.addEventListener('click', function() {
                    const currentUser = getCurrentUser();
                    if (currentUser) {
                        markNotificationsAsRead(currentUser.id);
                        showToast('All notifications marked as read', 'success');
                    }
                });
                
                // Close notification dropdown when clicking outside
                document.addEventListener('click', function(event) {
                    const dropdown = document.getElementById('notificationDropdown');
                    const bell = document.getElementById('notificationBell');
                    
                    if (dropdown && bell && !dropdown.contains(event.target) && !bell.contains(event.target)) {
                        dropdown.classList.remove('show');
                    }
                });
                
                // ========== WHATSAPP INTEGRATION ==========
                
                // WhatsApp button click
                document.getElementById('whatsappButton')?.addEventListener('click', function() {
                    showModal('whatsappModal');
                });
                
                // Send WhatsApp message
                document.getElementById('sendWhatsappBtn')?.addEventListener('click', function() {
                    const websiteSettings = getWebsiteSettings();
                    const message = document.getElementById('whatsappMessage').value || 'Hello, I have a question about the clan.';
                    
                    const phoneNumber = websiteSettings.whatsappNumber || '+2348159035074';
                    const encodedMessage = encodeURIComponent(message);
                    const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
                    
                    this.href = whatsappUrl;
                    
                    // Close modal after a short delay
                    setTimeout(() => {
                        hideModal('whatsappModal');
                        document.getElementById('whatsappMessage').value = '';
                    }, 100);
                });
                
                // ========== MULTI-TAB SYNCHRONIZATION ==========
                
                // Listen for storage changes (for multi-tab sync)
                window.addEventListener('storage', function() {
                    // Reload current page data if user is logged in
                    const currentUser = getCurrentUser();
                    if (currentUser) {
                        if (currentUser.isAdmin && document.getElementById('adminPage') && !document.getElementById('adminPage').classList.contains('hidden')) {
                            loadAdminDashboard();
                        } else if (!currentUser.isAdmin && document.getElementById('dashboardPage') && !document.getElementById('dashboardPage').classList.contains('hidden')) {
                            loadUserDashboard();
                        }
                    }
                });
                
                // Listen for database updates
                window.addEventListener('databaseUpdated', function() {
                    // Reload current page data if user is logged in
                    const currentUser = getCurrentUser();
                    if (currentUser) {
                        if (currentUser.isAdmin && document.getElementById('adminPage') && !document.getElementById('adminPage').classList.contains('hidden')) {
                            loadAdminDashboard();
                        } else if (!currentUser.isAdmin && document.getElementById('dashboardPage') && !document.getElementById('dashboardPage').classList.contains('hidden')) {
                            loadUserDashboard();
                        }
                    }
                });
                
                // ========== MOBILE MENU ==========
                
                // Mobile menu button
                document.getElementById('mobileMenuBtn')?.addEventListener('click', function() {
                    const navLinks = document.querySelector('.nav-links');
                    navLinks.style.display = navLinks.style.display === 'flex' ? 'none' : 'flex';
                });
                
                // Initial setup complete
                console.log('VOIDM - BSQUAD Clan Management System initialized');
                console.log('Features included:');
                console.log('1. Database server simulation');
                console.log('2. Always starts with login page');
                console.log('3. Max CODM level: 400');
                console.log('4. Admin can post events with notifications');
                console.log('5. Members-only features (events tab)');
                console.log('6. Admin can edit all user data');
                console.log('7. Recent activities visible only to admin');
            });
        </script>
    </body>
</html>